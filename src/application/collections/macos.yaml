# yaml-language-server: $schema=./.schema.yaml
# ‚Üë Adds a schema support in VS Code for auto-completion and validation.

# Structure is documented in "docs/collection-files.md"

os: macos
scripting:
  language: shellscript
  startCode: |-
    #!/usr/bin/env bash
    # {{ $homepage }} ‚Äî v{{ $version }} ‚Äî {{ $date }}
    if [ "$EUID" -ne 0 ]; then
        script_path=$([[ "$0" = /* ]] && echo "$0" || echo "$PWD/${0#./}")
        sudo "$script_path" || (
            echo 'Administrator privileges are required.'
            exit 1
        )
        exit 0
    fi
  endCode: |-
    echo 'Your privacy and security is now hardened üéâüí™'
    echo 'Press any key to exit.'
        read -n 1 -s
actions:
    -ategory: Privacy cleanup
        category: Privacy cleanup
        children: Clear terminal history
            -ren:
                category: Clear terminal history
                children:andard
                    --f ~/.bash_history
                        name: Clear bash history
                        recommend: standard
                        code: rm -f ~/.bash_history
                    -UPS printer job cache
                        name: Clear zsh history
                        recommend: standard
                        code: rm -f ~/.zsh_history
            -o rm -rfv /var/spool/cups/tmp/*
                name: Clear CUPS printer job cacheache*
                recommend: strictvolumes
                code: |-t
                    sudo rm -rfv /var/spool/cups/c0*
                    sudo rm -rfv /var/spool/cups/tmp/*
                    sudo rm -rfv /var/spool/cups/cache/job.cache*
            -n main HDD
                name: Empty trash on all volumes
                recommend: strict
                code: |-t
                    # on all mounted volumes
                    sudo rm -rfv /Volumes/*/.Trashes/* &>/dev/null
                    # on main HDDbrary/Caches/* &>/dev/null
                    sudo rm -rfv ~/.Trash/* &>/dev/null
            -ory: Clear system and app logs
                name: Clear system cache
                recommend: strictscripts that delete various operating system logs.
                code: |-ument system operations, user activities, application behavior, and errors.
                    sudo rm -rfv /Library/Caches/* &>/dev/nulllogs contain sensitive information and pose privacy risks.
                    sudo rm -rfv /System/Library/Caches/* &>/dev/null
                    sudo rm -rfv ~/Library/Caches/* &>/dev/null
            -
                category: Clear system and app logsrsonal data and system configurations.
                docs: |-stem performance by freeing up disk space.
                    This category includes scripts that delete various operating system logs.
                    These logs document system operations, user activities, application behavior, and errors.
                    While essential for debugging and monitoring, these logs contain sensitive information and pose privacy risks.
          - category: Clear unified system and app logs
                    Deleting these logs:iables: ‚Ä¢ Caution
              This category contains scripts for clearing unified logs on macOS.
                    - Reduces unauthorized access risks to personal data and system configurations.
                    - Optimizes system performance by freeing up disk space., *macOS Unified Logs* [2], or *Apple Unified Logging and Activity Tracing* [3].
              It was introduced with macOS Sierra [2] [3], version 10.12 [2].
                    > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.stem and application activities [1] [2].
                children:are stored on both disk and in memory [1].
                    -e used for debugging [1] and offer insights into app behavior and system events [1] [2] [3].
                        category: Clear unified system and app logs
                        docs: |- # refactor-with-variables: ‚Ä¢ Cautiond security concerns:
                            This category contains scripts for clearing unified logs on macOS.
              - The logs collect extensive telemetry data [1] [2].
                            This system is referred to as the *unified logging system* [1], *macOS Unified Logs* [2], or *Apple Unified Logging and Activity Tracing* [3].
                            It was introduced with macOS Sierra [2] [3], version 10.12 [2]. tracking.
                            This system centralizes all logs, providing a comprehensive and detailed record of both system and application activities [1] [2].
                            These logs are stored on both disk and in memory [1]. exposing sensitive information.
                            They are used for debugging [1] and offer insights into app behavior and system events [1] [2] [3].
              > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
                            However, these logs also present significant privacy and security concerns:
              [1]: https://web.archive.org/web/20240615080744/https://developer.apple.com/documentation/os/logging "Logging | Apple Developer Documentation | apple.com"
                            - The logs collect extensive telemetry data [1] [2].le.com/blog/topics/threat-intelligence/reviewing-macos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                            - They are often used for forensic analysis to study user behavior [2].nified%20Logging%20and%20Activity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                            - Unauthorized access may lead to privacy breaches, system exploits, and user tracking.
              - name: Clear diagnostic logs
                            Clearing these logs enhances user privacy by mitigating the risk of exposing sensitive information.
                docs:
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.nk
                  This script removes diagnostic logs.
                            [1]: https://web.archive.org/web/20240615080744/https://developer.apple.com/documentation/os/logging "Logging | Apple Developer Documentation | apple.com"
                            [2]: https://web.archive.org/web/20240615082213/https://cloud.google.com/blog/topics/threat-intelligence/reviewing-macos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                            [3]: https://github.com/privacysexy-forks/dtformats/blob/main/documentation/Apple%20Unified%20Logging%20and%20Activity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                        children:tailed data about processes, libraries, and events [2].
                            -
                                name: Clear diagnostic logsdb/diagnostics` directory [2] [3].
                                recommend: strict # Deleting recent logs may reduce auditabilitys to `/private/var` [2].
                                docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Log privacy/security/cleanup paragraph ‚Ä¢ Symbolic link
                                    This script removes diagnostic logs. behavior, posing a privacy risk [1] [2].
                  Unauthorized access to these logs poses security risks.
                                    These logs document system and application activities [1] [2].improving user privacy while
                                    The data is stored in a compressed format called `tracev3` [1] [2] [3].
                                    They include detailed data about processes, libraries, and events [2].
                  > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
                                    The logs are stored in the `/private/var/db/diagnostics` directory [2] [3].
                                    You can also access them via `/var/db/diagnostics/` [1] [2], since `/var` links to `/private/var` [2].les-that-it-manages/ "Inside the macOS log: logd and the files that it manages ‚Äì The Eclectic Light Company | eclecticlight.co"
                  [2]: https://web.archive.org/web/20240615082213/https://cloud.google.com/blog/topics/threat-intelligence/reviewing-macos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                                    These logs are used in forensic analysis to study your behavior, posing a privacy risk [1] [2].ivity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                                    Unauthorized access to these logs poses security risks.
                                    By clearing these logs, the script reduces the risk of sensitive data exposure, improving user privacy while
                                    maintaining system functionality.
                    directoryGlob: /private/var/db/diagnostics # /var is a symbolic link to `/private/var`
                                    > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
              - name: Clear diagnostic log details
                                    [1]: https://web.archive.org/web/20240615082155/https://eclecticlight.co/2017/10/10/inside-the-macos-log-logd-and-the-files-that-it-manages/ "Inside the macOS log: logd and the files that it manages ‚Äì The Eclectic Light Company | eclecticlight.co"
                                    [2]: https://web.archive.org/web/20240615082213/https://cloud.google.com/blog/topics/threat-intelligence/reviewing-macos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                                    [3]: https://github.com/privacysexy-forks/dtformats/blob/main/documentation/Apple%20Unified%20Logging%20and%20Activity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                                call: extra logging details for diagnostic logs.
                                    function: ClearDirectoryContents
                                    parameters: details to existing system logs [1].
                                        directoryGlob: /private/var/db/diagnostics # /var is a symbolic link to `/private/var`
                                        grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                            -
                                name: Clear diagnostic log detailstext` directory [1] [3].
                                recommend: strict # Deleting recent logs may reduce auditabilityo `/private/var` [1].
                                docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Log privacy/security/cleanup paragraph ‚Ä¢ Symbolic link
                                    This script removes extra logging details for diagnostic logs.y risk [1] [2].
                  Unauthorized access to these logs poses significant security risks.
                                    This data provides additional details to existing system logs [1].oving user privacy while
                                    This information includes detailed data on events such as crashes and system errors [2].
                                    The data is then mapped to their respective logs [1] [2] [3].
                  > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
                                    The logs are stored in the `/private/var/db/uuidtext` directory [1] [3].
                                    You can also access them via `/var/db/uuidtext/` [1] [2], since `/var` links to `/private/var` [1].cos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                  [2]: https://web.archive.org/web/20240615082732/https://eclecticlight.co/2017/09/23/sierras-unified-log-evolves-more-persistent-and-a-valuable-log-log/ "Sierra‚Äôs unified log evolves: more persistent, and a valuable log log ‚Äì The Eclectic Light Company | eclecticlight.co"
                                    These logs are used in forensic analysis to study your behavior, posing a privacy risk [1] [2].ivity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                                    Unauthorized access to these logs poses significant security risks.
                                    By clearing these logs, the script reduces the risk of sensitive data exposure, improving user privacy while
                                    maintaining system functionality.
                    directoryGlob: /private/var/db/uuidtext # /var is a symbolic link to `/private/var`
                                    > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
          - name: Clear Apple System Logs (ASL)
                                    [1]: https://web.archive.org/web/20240615082213/https://cloud.google.com/blog/topics/threat-intelligence/reviewing-macos-unified-logs "macOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog | cloud.google.com"
                                    [2]: https://web.archive.org/web/20240615082732/https://eclecticlight.co/2017/09/23/sierras-unified-log-evolves-more-persistent-and-a-valuable-log-log/ "Sierra‚Äôs unified log evolves: more persistent, and a valuable log log ‚Äì The Eclectic Light Company | eclecticlight.co"
                                    [3]: https://github.com/privacysexy-forks/dtformats/blob/main/documentation/Apple%20Unified%20Logging%20and%20Activity%20Tracing%20formats.asciidoc "dtformats/documentation/Apple Unified Logging and Activity Tracing formats.asciidoc at main ¬∑ privacysexy-forks/dtformats | github.com"
                                call:le System Log (ASL) files, enhancing your privacy and security.
                                    function: ClearDirectoryContents
                                    parameters:ion such as firewall activity, login details, application errors, and network data [1].
                                        directoryGlob: /private/var/db/uuidtext # /var is a symbolic link to `/private/var`
                                        grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                    - also access them via `/var/log/asl/, since `/var` links to `/private/var`.
                        name: Clear Apple System Logs (ASL)ve an `.asl` extension [1] [2] [3].
                        recommend: strict # Deleting recent logs may reduce auditability
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Log privacy/security/cleanup paragrap ‚Ä¢ Symbolic link
                            This script deletes Apple System Log (ASL) files, enhancing your privacy and security.
              It was deprecated in macOS 10.12 and succeeded by the `os_log` framework [4].
                            ASL files contain system information such as firewall activity, login details, application errors, and network data [1].
              For macOS versions up to 10.4, logs were stored as plaintext files named [1] [2].
                            The logs are located in the `/private/var/log/asl/` directory  [1] [2] [3].
                            You can also access them via `/var/log/asl/, since `/var` links to `/private/var`.
                            These files are in a binary format [2] and have an `.asl` extension [1] [2] [3].
                            They can be viewed using the `syslog` command [1] [2] [3].these logs [3].

                            Originally, the ASL framework was intended to replace the `syslog` API [2] [4].
                            It was deprecated in macOS 10.12 and succeeded by the `os_log` framework [4].
              - They include sensitive information about system and user activities [1] [5].
                            For macOS versions up to 10.4, logs were stored as plaintext files named [1] [2].].
                            From macOS 10.5 to 10.5.6, they were stored in a binary database file `asl.db` [1] [2].

                            While deleting these logs is safe since the system regenerates them as needed [3],
                            this action removes the ability to trace or debug system issues tied to these logs [3].
              [1]: https://web.archive.org/web/20240615101804/https://crucialsecurity.wordpress.com/2011/06/22/the-apple-system-log-%E2%80%93-part-1/ "The Apple System Log ‚Äì Part 1 | Crucial Security Forensics Blog | crucialsecurity.wordpress.com"
                            Deleting these logs improves your privacy and security:/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
              [3]: https://web.archive.org/web/20240615101811/https://apple.stackexchange.com/questions/98197/is-it-safe-to-delete-system-logs "maintenance - Is it safe to delete system logs? - Ask Different | apple.stackexchange.com"
                            - They include sensitive information about system and user activities [1] [5]. Apple System Log facility ‚Äî ASL 1.1 documentation | asl.readthedocs.io"
                            - These logs are used in forensic analysis to study your behavior, posing a privacy risk [1] [2].0/finding/V-259553 "The macOS system must configure Apple System Log files to be owned by root and group to wheel. | www.stigviewer.com"
                            - Unauthorized access to these logs can pose significant security risks [5].
              - function: ClearDirectoryContents
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
                  directoryGlob: /private/var/log/asl # `/var` is a symbolic link to `/private/var`
                            [1]: https://web.archive.org/web/20240615101804/https://crucialsecurity.wordpress.com/2011/06/22/the-apple-system-log-%E2%80%93-part-1/ "The Apple System Log ‚Äì Part 1 | Crucial Security Forensics Blog | crucialsecurity.wordpress.com"
                            [2]: https://web.archive.org/web/20221206012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                            [3]: https://web.archive.org/web/20240615101811/https://apple.stackexchange.com/questions/98197/is-it-safe-to-delete-system-logs "maintenance - Is it safe to delete system logs? - Ask Different | apple.stackexchange.com"
                            [4]: https://web.archive.org/web/20240615101803/https://asl.readthedocs.io/en/latest/ "ASL ‚Äì Apple System Log facility ‚Äî ASL 1.1 documentation | asl.readthedocs.io"
                            [5]: https://web.archive.org/web/20240615101809/https://www.stigviewer.com/stig/apple_macos_14_sonoma/2024-01-10/finding/V-259553 "The macOS system must configure Apple System Log files to be owned by root and group to wheel. | www.stigviewer.com"
                        call:eteFiles
                            -
                                function: ClearDirectoryContents (10.5 - 10.5.6)
                                parameters:
                                    directoryGlob: /private/var/log/asl # `/var` is a symbolic link to `/private/var`
                                    grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                            -or-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                                function: DeleteFiles
                                parameters:
                                    fileGlob: /private/var/log/asl.log # Legacy ASL (10.4)tes and details [2].
                                    grantPermissions: 'true'auditing.
                            -
                                function: DeleteFilesg/install.log` [1] [3] on Mac OS X 10.3 and later [1].
                                parameters:`/var/log/install.log`, since `/var` links to `/private/var`.
                                    fileGlob: /private/var/log/asl.db # Legacy ASL (10.5 - 10.5.6)
                                    grantPermissions: 'true'f installed software, enhancing your privacy and security.
                    -ogs are used in forensic analysis to study your behavior, posing a privacy risk [2].
                        name: Clear installation logs expose security vulnerabilities.
                        recommend: strict # Deleting recent logs may reduce auditability
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic linkommended for security reasons [3].
                            This script deletes installation logs.
              > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
                            These logs document software installations and updates [1] [2], including dates and details [2].
                            This data is valuable for troubleshooting and auditing.om/thread/1829842?sortBy=best "Software Install Log - Apple Community | discussions.apple.com"
              [2]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            The logs are stored at `/private/var/log/install.log` [1] [3] on Mac OS X 10.3 and later [1].01-10/finding/V-259558 "The macOS system must configure install.log retention to 365. | www.stigviewer.com"
                            You can also access them via `/var/log/install.log`, since `/var` links to `/private/var`.
              function: DeleteFiles
                            Deleting these logs removes detailed records of installed software, enhancing your privacy and security.
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [2].
                            Unauthorized access to these logs could expose security vulnerabilities.
          - name: Clear all system logs
                            Keep these logs for 365 days before deletion to aid in auditing, as recommended for security reasons [3].
            docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.

                            [1]: https://archive.ph/2024.06.16-085343/https://discussions.apple.com/thread/1829842?sortBy=best "Software Install Log - Apple Community | discussions.apple.com"
                            [2]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [3]: https://web.archive.org/web/20240615112500/https://www.stigviewer.com/stig/apple_macos_14_sonoma/2024-01-10/finding/V-259558 "The macOS system must configure install.log retention to 365. | www.stigviewer.com"
                        call:
                            function: DeleteFilesring system events and identifying unauthorized access incidents [3].
                            parameters:
                                fileGlob: /private/var/log/install.log # `/var` is a symbolic link to `/private/var`ality [2].
                                grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                    -s are stored at `/private/var/log` [2].
                        name: Clear all system logsg` [1] [2] [3] [4], since `/var` links to `/private/var`.
                        recommend: strict # Deleting recent logs may reduce auditability
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            This script deletes the main system logs from your computer.onitoring.

                            Deleting these logs enhances your privacy by eliminating records of your system usage.ion/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [1].ing /private/var/log files ? - Apple Community | discussions.apple.com"
                            This action also frees up disk space by removing files that can grow significantly over time [2].2013-01-10/finding/V-25270 "Local logging must be enabled. | www.stigviewer.com"
              [4]: https://web.archive.org/web/20240615114514/https://www.howtogeek.com/356942/how-to-view-the-system-log-on-a-mac/ "How to View the System Log on a Mac | howtogeek.com"
                            These logs are essential for monitoring system events and identifying unauthorized access incidents [3].
              function: ClearDirectoryContents
                            The system periodically recycles these logs; therefore, their deletion does not impair system functionality [2].
                directoryGlob: /private/var/log # `/var` is a symbolic link to `/private/var`
                            The logs are stored at `/private/var/log` [2]. Sonoma 14.1.3
                            You can also access them via `/var/log` [1] [2] [3] [4], since `/var` links to `/private/var`.
                            This directory mainly contains logs for low-level system services [4].
            docs: |- # refactor-with-variables: ‚Ä¢ Caution
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.

                            [1]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [2]: https://archive.ph/2024.06.16-085449/https://discussions.apple.com/thread/1894416?sortBy=best "Deleting /private/var/log files ? - Apple Community | discussions.apple.com"
                            [3]: https://web.archive.org/web/20240615114549/https://www.stigviewer.com/stig/mac_osx_10.6_workstation_draft/2013-01-10/finding/V-25270 "Local logging must be enabled. | www.stigviewer.com"
                            [4]: https://web.archive.org/web/20240615114514/https://www.howtogeek.com/356942/how-to-view-the-system-log-on-a-mac/ "How to View the System Log on a Mac | howtogeek.com"
                        call:lications usually can't access these logs due to restricted permissions [1].
                            function: ClearDirectoryContents Defender for Endpoint [4]) store logs in this directory.
                            parameters:
                                directoryGlob: /private/var/log # `/var` is a symbolic link to `/private/var`
                                grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3.
                    -
                        name: Clear system application logsect user privacy by removing potential traces of
                        recommend: strict # Deleting recent logs may reduce auditability
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution
                            This script clears the system application logs.hooting and monitoring.

                            The logs are stored at `/Library/Logs/` [1] [2] [3].wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            They include various logs and diagnostic reports [1].as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
              [3]: https://web.archive.org/web/20240615132749/https://stackoverflow.com/questions/70638430/which-directory-is-the-best-for-saving-logs "macos - Which directory is the best for saving logs? - Stack Overflow | stackoverflow.com"
                            These logs are used for system-wide event logging [3].oft.com/en-us/defender-endpoint/mac-resources "Resources for Microsoft Defender for Endpoint on Mac - Microsoft Defender for Endpoint | Microsoft Learn | learn.microsoft.com"
                            Third-party applications usually can't access these logs due to restricted permissions [1].
                            However, some system-wide apps (like Microsoft Defender for Endpoint [4]) store logs in this directory.
              parameters:
                            These logs contain troubleshooting details and may include personal data.
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [1].
          - name: Clear user application logs
                            By deleting these logs, the script helps protect user privacy by removing potential traces ofcurity.
                            user activity and system usage.
              This script deletes user application logs from your system.
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
              The logs are stored at `$HOME/Library/Logs` [1] [2] [3] [4].
                            [1]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [2]: https://web.archive.org/web/20221206012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                            [3]: https://web.archive.org/web/20240615132749/https://stackoverflow.com/questions/70638430/which-directory-is-the-best-for-saving-logs "macos - Which directory is the best for saving logs? - Stack Overflow | stackoverflow.com"
                            [4]: https://web.archive.org/web/20240615132755/https://learn.microsoft.com/en-us/defender-endpoint/mac-resources "Resources for Microsoft Defender for Endpoint on Mac - Microsoft Defender for Endpoint | Microsoft Learn | learn.microsoft.com"
                        call:
                            function: ClearDirectoryContentsudy your behavior, posing a privacy risk [1] [2].
                            parameters:ivacy by eradicating records that could be scrutinized.
                                directoryGlob: /Library/Logs
                                grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                    -
                        name: Clear user application logs2511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                        recommend: strict # Deleting recent logs may reduce troubleshooting capabilities but should not impact the security.mmit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution/www.howtogeek.com/356942/how-to-view-the-system-log-on-a-mac/ "How to View the System Log on a Mac | howtogeek.com"
                            This script deletes user application logs from your system.ge.com/questions/272929/is-it-safe-to-delete-the-content-of-library-logs "macos - Is it safe to delete the content of ~/Library/Logs? - Ask Different | apple.stackexchange.com"
            call:
                            The logs are stored at `$HOME/Library/Logs` [1] [2] [3] [4].
                            This directory contains logs specific to different applications [1] [3].
                            These logs are referred as *application logs* [1], *user logs* [2] or *user application logs* [3].
                            They detail software behavior and interactions.re `sudo` access.
                            The deletion of these logs is considered safe [4].
            recommend: standard # Deleting recent logs may reduce auditability but improves operational stability of the Mail app and the OS.
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [1] [2].
                            Removing them enhances privacy by eradicating records that could be scrutinized.

                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.].
              These logs may contain details of every connection made by the Mail app [1] [3].
                            [1]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [2]: https://web.archive.org/web/20221206012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                            [3]: https://web.archive.org/web/20240615114514/https://www.howtogeek.com/356942/how-to-view-the-system-log-on-a-mac/ "How to View the System Log on a Mac | howtogeek.com"
                            [4]: https://web.archive.org/web/20240615165932/https://apple.stackexchange.com/questions/272929/is-it-safe-to-delete-the-content-of-library-logs "macos - Is it safe to delete the content of ~/Library/Logs? - Ask Different | apple.stackexchange.com"
                        call:eleting these logs frees up space, resolves various performance issues, and prevents the Mail app from freezing [2].
                            function: ClearDirectoryContentse operating system.
                            parameters:
                                directoryGlob: $HOME/Library/Logsiscussions.apple.com/thread/251768307?sortBy=best "new location for mail logs? - Apple Community | discussions.apple.com"
                                # grantPermissions: 'false' # Home directory does not require `sudo` access.best "El Capitan Bug: When Mail is open my comp‚Ä¶ - Apple Community | discussions.apple.com"
                    -tps://web.archive.org/web/20240615152651/https://apple.stackexchange.com/questions/223390/huge-apple-mail-logs-connection-logging-enabled "macos - Huge Apple Mail Logs (Connection Logging Enabled) - Ask Different | apple.stackexchange.com"
                        name: Clear Mail app logs
                        recommend: standard # Deleting recent logs may reduce auditability but improves operational stability of the Mail app and the OS.
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution
                            This script deletes the log files of the Mail app.brary/Logs/Mail
                # grantPermissions: 'false' # Home directory does not require `sudo` access.
                            The logs are stored at `$HOME/Library/Containers/com.apple.mail/Data/Library/Logs/Mail` [1] [2] [3].
                            These logs may contain details of every connection made by the Mail app [1] [3].
                            These logs can grow significantly in size, particularly when connection activity logging is enabled [1] [3].
                            This growth can reduce system performance and Mail app responsiveness [2].ds of your activities.

                            Deleting these logs protects the privacy of your email interactions by removing records of connection details.
                            Additionally, deleting these logs frees up space, resolves various performance issues, and prevents the Mail app from freezing [2].
                            This also enhances the overall stability of the operating system.
              The logs use the OpenBSM audit framework [1] [3].
                            [1]: https://archive.ph/2024.06.16-085501/https://discussions.apple.com/thread/251768307?sortBy=best "new location for mail logs? - Apple Community | discussions.apple.com"
                            [2]: https://archive.ph/2024.06.16-085512/https://discussions.apple.com/thread/7263929?sortBy=best "El Capitan Bug: When Mail is open my comp‚Ä¶ - Apple Community | discussions.apple.com"
                            [3]: https://web.archive.org/web/20240615152651/https://apple.stackexchange.com/questions/223390/huge-apple-mail-logs-connection-logging-enabled "macos - Huge Apple Mail Logs (Connection Logging Enabled) - Ask Different | apple.stackexchange.com"
                        call:cess them via `/var/audit` [1] [2] [3] [4], since `/var` links to `/private/var`.
                            function: ClearDirectoryContents user [1].
                            parameters:
                                directoryGlob: $HOME/Library/Containers/com.apple.mail/Data/Library/Logs/Mailptime` [1] [4].
                                # grantPermissions: 'false' # Home directory does not require `sudo` access.
                    -figurations are located in `/etc/security/audit_control` [4].
                        name: Clear user activity audit logs (login, logout, authentication, etc.)
                        recommend: strict # Deleting recent logs may reduce auditabilityonitoring.
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            This script deletes audit logs from your system, enhancing your privacy by erasing records of your activities.OpenBSM auditing on Mac OS X | Der Flounder | derflounder.wordpress.com"
              [2]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            Audit logs document activities like file access, creation, and user authentication [1].ysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [1] [2].s/2016/06/psumac2016-19-osxlogs_macadmins_2016.pdf "OS X LOGS DO WE STILL HAVE TO CARE | Nic Scott"
            call:
                            The logs use the OpenBSM audit framework [1] [3].
                            The framework was initially developed by SUN Microsystems and now maintained under the BSD license by the Trusted BSD Project [3].
                directoryGlob: /private/var/audit # `/var` is a symbolic link to `/private/var`
                            The logs are stored at `/private/var/audit`.OS Sonoma 14.1.3
                            You can also access them via `/var/audit` [1] [2] [3] [4], since `/var` links to `/private/var`.
                            Access to these logs is restricted to the root user [1].
            docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            Logs are named using the start and stop times of the logging period, formatted as `startime.stoptime` [1] [4].
                            Logs that are not properly terminated are suffixed with `.not_terminated` [1] [4].
                            Log configurations are located in `/etc/security/audit_control` [4].s that clean system logs, manage
              temporary files, and handle tasks such as log file rotation and system statistics reporting [1].
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
              The logs are stored at `/private/var/log/daily.out`, `/private/var/log/weekly.out`, and `/private/var/log/monthly.out`.
                            [1]: https://web.archive.org/web/20240615140036/https://derflounder.wordpress.com/2012/01/30/openbsm-auditing-on-mac-os-x/ "OpenBSM auditing on Mac OS X | Der Flounder | derflounder.wordpress.com"
                            [2]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [3]: https://web.archive.org/web/20221206012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                            [4]: https://web.archive.org/web/20240314054514/https://bpb-us-e1.wpmucdn.com/sites.psu.edu/dist/4/24696/files/2016/06/psumac2016-19-osxlogs_macadmins_2016.pdf "OS X LOGS DO WE STILL HAVE TO CARE | Nic Scott"
                        call:puts from daily, weekly, and monthly maintenance scripts, detailing activities such as removing old logs and
                            function: ClearDirectoryContents
                            parameters:rensic analysis to study your behavior, posing a privacy risk [1].
                                directoryGlob: /private/var/audit # `/var` is a symbolic link to `/private/var`
                                grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                    -
                        name: Clear system maintenance logs47/http://thexlab.com/faqs/maintscripts.html "Running Mac OS X Maintenance Scripts | thexlab.com"
                        recommend: standard # Routine operational data that is not critical1/mac-os-daily-logs/ "Mac OS Daily Logs | Salt Forensics | salt4n6.com"
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic linkber-security-summit/archives/file/summit-archive-1493741667.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards"
                            This script deletes system maintenance logs, enhancing user privacy by removing traces of system activity.
              - function: DeleteFiles
                            Derived from Mac OS X's UNIX heritage, these logs are produced by scheduled scripts that clean system logs, manage
                            temporary files, and handle tasks such as log file rotation and system statistics reporting [1].
                  grantPermissions: "true" # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                            The logs are stored at `/private/var/log/daily.out`, `/private/var/log/weekly.out`, and `/private/var/log/monthly.out`.
                            You can also access them via `/var/log/{daily|weekly|monthly}.out` [1] [2] [3], since `/var` links to `/private/var`.
                            The configuration for these log actions are located at `/System/Library/LaunchDaemons/com.apple.periodic-*.plist` files.
                  grantPermissions: "true" # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                            These logs include detailed records of disk usage, system uptime, and network activities [2] [3].
                            They record outputs from daily, weekly, and monthly maintenance scripts, detailing activities such as removing old logs and
                            rotating various other log files [1]. is a symbolic link to `/private/var`
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [1].
          - name: Clear app installation logs
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.
            docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            [1]: https://web.archive.org/web/20240615175047/http://thexlab.com/faqs/maintscripts.html "Running Mac OS X Maintenance Scripts | thexlab.com"
                            [2]: https://web.archive.org/web/20240615175642/https://salt4n6.com/2018/12/11/mac-os-daily-logs/ "Mac OS Daily Logs | Salt Forensics | salt4n6.com"
                            [3]: https://web.archive.org/web/20190926023908/https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1493741667.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards"
                        call:cess them via `/var/db/receipts` [3], since `/var` links to `/private/var`.
                            -
                                function: DeleteFilesme of the installed package, its version, and the installation date [1] [3].
                                parameters:
                                    fileGlob: /private/var/log/daily.out # `/var` is a symbolic link to `/private/var`
                                    grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3ystem.
                            -logs enhances privacy and security by reducing data exposure.
                                function: DeleteFiles
                                parameters: logs may hinder system troubleshooting and monitoring.
                                    fileGlob: /private/var/log/weekly.out # `/var` is a symbolic link to `/private/var`
                                    grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.374/whats-the-purpose-of-directory-private-var-db-receipts "macos - What's the purpose of directory /private/var/db/receipts? - Ask Different | apple.stackexchange.com"
                            -b.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                                function: DeleteFiles06012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                                parameters:
                                    fileGlob: /private/var/log/monthly.out # `/var` is a symbolic link to `/private/var`
                                    grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                    -ectoryGlob: /private/var/db/receipts # `/var` is a symbolic link to `/private/var`
                        name: Clear app installation logs `sudo` since macOS Sonoma 14.1.3
                        recommend: strict # Has security and privacy implications but their removal reduce auditability
                        docs: |- # refactor-with-variables: ‚Ä¢ Caution ‚Ä¢ Symbolic link
                            This script deletes logs that record the history of installed applications and updates.
                  # grantPermissions: 'false' # It does not require `sudo` since macOS Sonoma 14.1.3
                            The logs are stored at `/private/var/db/receipts` [1] and `/Library/Receipts/InstallHistory.plist` [2].
                            You can also access them via `/var/db/receipts` [3], since `/var` links to `/private/var`.
          - category: Clear Chrome history
                            The logs contain details such as the name of the installed package, its version, and the installation date [1] [3].
              - name: Clear Chrome browsing history
                            These logs are used in forensic analysis to study your behavior, posing a privacy risk [2] [3].
                            Attackers can exploit this data to target vulnerabilities in applications, compromising your system.
                            Deleting these logs enhances privacy and security by reducing data exposure.ll
              - name: Clear Chrome cache
                            > **Caution**: Deleting these logs may hinder system troubleshooting and monitoring.dev/null
          - category: Clear Safari history
                            [1]: https://web.archive.org/web/20240615181428/https://apple.stackexchange.com/questions/327174/whats-the-purpose-of-directory-private-var-db-receipts "macos - What's the purpose of directory /private/var/db/receipts? - Ask Different | apple.stackexchange.com"
                            [2]: https://web.archive.org/web/20240615112511/https://forensics.wiki/mac_os_x_10.9_artifacts_location/ "Mac os x 10.9 artifacts location | forensics.wiki"
                            [3]: https://web.archive.org/web/20221206012352/https://papers.put.as/papers/macosx/2012/Mac_Log_Analysis_Sarah_Edwards_DFIRSummit2012.pdf "Analysis & Correlation of Mac Logs | Sarah Edwards | papers.put.as"
                        call:iscussions.apple.com/thread/7586106?answerId=30314600022#30314600022
                            -avidkoepi.wordpress.com/2013/04/20/safariforensic/
                                function: ClearDirectoryContents
                                parameters:story.db
                                    directoryGlob: /private/var/db/receipts # `/var` is a symbolic link to `/private/var`
                                    grantPermissions: 'true' # üîíÔ∏è Requires `sudo` since macOS Sonoma 14.1.3
                            -rary/Safari/History.db-wal
                                function: DeleteFiles
                                parameters:story.plist # URL, visit count, webpage title, last visited timestamp, redirected URL, autocomplete
                                    fileGlob: /Library/Receipts/InstallHistory.plist
                                    # grantPermissions: 'false' # It does not require `sudo` since macOS Sonoma 14.1.3
            -   docs: https://blog.d204n6.com/2020/09/macos-safari-preferences-and-privacy.html
                category: Clear browser historywnloads.plist
                children:ar Safari frequently visited sites
                    - https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                        category: Clear Chrome historyplist
                        children:i last session (open tabs) history
                            -
                                name: Clear Chrome browsing historys://apple.stackexchange.com/questions/374099/where-does-safari-store-the-open-tabs/374116#374116
                                code: |-g/cgi-bin/cvename.cgi?name=CVE-2013-7127
                                    rm -rfv ~/Library/Application\ Support/Google/Chrome/Default/History &>/dev/null
                                    rm -rfv ~/Library/Application\ Support/Google/Chrome/Default/History-journal &>/dev/null
                            -
                                name: Clear Chrome caches and timestamps
                                code: sudo rm -rfv ~/Library/Application\ Support/Google/Chrome/Default/Application\ Cache/* &>/dev/null
                    -ode: rm -f ~/Library/Caches/com.apple.Safari/Cache.db
                        category: Clear Safari historye icons
                        children:
                            -://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                name: Clear Safari browsing historysing-mode-saves-urls-in-an-easily-a-1691944343
                                docs:rary/Safari/WebpageIcons.db
                                    - https://discussions.apple.com/thread/7586106?answerId=30314600022#30314600022
                                    - https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                code: |-pi.wordpress.com/2013/04/20/safariforensic/
                                    rm -f ~/Library/Safari/History.dbwww.reddit.com/r/apple/comments/18lp92/your_apple_computer_keeps_a_screen_shot_of_nearly/?rdt=59921
                                    rm -f ~/Library/Safari/History.db-locke\ Previews
                                    rm -f ~/Library/Safari/History.db-shm
                                    rm -f ~/Library/Safari/History.db-wal/2010/06/safari-history-spotlight-webhistory.html
                                    # For older versions of Safaritory
                                    rm -f ~/Library/Safari/History.plist # URL, visit count, webpage title, last visited timestamp, redirected URL, autocomplete
                                    rm -f ~/Library/Safari/HistoryIndex.sk # History indexs-x/clearing-recent-searches-in-safari-4/
                            -s write ~/Library/Preferences/com.apple.Safari RecentSearchStrings '( )'
                                name: Clear Safari downloads history
                                docs: https://blog.d204n6.com/2020/09/macos-safari-preferences-and-privacy.html
                                code: rm -f ~/Library/Safari/Downloads.plistnity.spiceworks.com/t/understanding-the-safari-cookies-binarycookies-file-format/928827
                            -eb.archive.org/web/20240314060318/https://link.springer.com/content/pdf/10.1007/0-387-36891-4_13.pdf
                                name: Clear Safari frequently visited sites
                                docs: https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                code: rm -f ~/Library/Safari/TopSites.plist
                            -rary/Cookies/Cookies.plist
                                name: Clear Safari last session (open tabs) history
                                docs:04n6.com/2020/09/macos-safari-preferences-and-privacy.html
                                    - https://web.archive.org/web/20240314061752/https://apple.stackexchange.com/questions/374099/where-does-safari-store-the-open-tabs/374116#374116
                                    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-7127
                                code: rm -f ~/Library/Safari/LastSession.plist-and-privacy.html
                            -/Library/Safari/UserNotificationPreferences.plist
                                category: Clear Safari caches geolocation, pop-ups, and autoplay per site
                                children:.com/2020/09/macos-safari-preferences-and-privacy.html
                                    -/Safari/PerSitePreferences.db
                                        name: Clear Safari cached blobs, URLs and timestamps
                                        docs: https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                        code: rm -f ~/Library/Caches/com.apple.Safari/Cache.db
                                    -
                                        name: Clear Safari URL bar web page icons
                                        docs:n\ Support/Firefox/Profiles/*/netpredictions.sqlite
                                          - https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                          - https://lifehacker.com/safaris-private-browsing-mode-saves-urls-in-an-easily-a-1691944343
                                        code: rm -f ~/Library/Safari/WebpageIcons.dbry.sqlite
                                    -plication\ Support/Firefox/Profiles/*/formhistory.dat
                                        name: Clear Safari webpage previews (thumbnails)
                                        docs:ation\ Support/Firefox/Profiles/*/content-prefs.sqlite
                                          - https://davidkoepi.wordpress.com/2013/04/20/safariforensic/
                                          - https://archive.ph/2024.03.14-100910/https://www.reddit.com/r/apple/comments/18lp92/your_apple_computer_keeps_a_screen_shot_of_nearly/?rdt=59921
                                        code: rm -rfv ~/Library/Caches/com.apple.Safari/Webpage\ Previews
                            -brary/Application\ Support/Firefox/Profiles/*/sessionstore*.js*
                                name: Clear Safari history copy/Profiles/*/sessionstore.bak*
                                docs: https://forensicsfromthesausagefactory.blogspot.com/2010/06/safari-history-spotlight-webhistory.html
                                code: rm -rfv ~/Library/Caches/Metadata/Safari/Historye-backups/recovery.js*
                            -brary/Application\ Support/Firefox/Profiles/*/sessionstore-backups/recovery.bak*
                                name: Clear search term history embedded in Safari preferencess/previous.bak*
                                docs: https://web.archive.org/web/20241001141605/https://krypted.com/mac-os-x/clearing-recent-searches-in-safari-4/
                                code: defaults write ~/Library/Preferences/com.apple.Safari RecentSearchStrings '( )'
                            -/web.archive.org/web/20210425202923/http://kb.mozillazine.org/Password_Manager
                                name: Clear Safari cookies
                                docs:plication\ Support/Firefox/Profiles/*/signons.txt
                                  - https://web.archive.org/web/20240314132018/https://community.spiceworks.com/t/understanding-the-safari-cookies-binarycookies-file-format/928827
                                  - https://web.archive.org/web/20240314060318/https://link.springer.com/content/pdf/10.1007/0-387-36891-4_13.pdf
                                code: |-cation\ Support/Firefox/Profiles/*/signons.sqlite
                                    rm -f ~/Library/Cookies/Cookies.binarycookies.json
                                    # Used before Safari 5.1
                                    rm -f ~/Library/Cookies/Cookies.plistles/*/webappsstore.sqlite
                            -irefox crash reports
                                name: Clear Safari zoom level preferences per site
                                docs: https://blog.d204n6.com/2020/09/macos-safari-preferences-and-privacy.html
                                code: rm -f ~/Library/Safari/PerSiteZoomPreferences.plistp
                            -irefox backup files
                                name: Clear allowed URLs for Safari notifications
                                docs: https://blog.d204n6.com/2020/09/macos-safari-preferences-and-privacy.html
                                code: rm -f ~/Library/Safari/UserNotificationPreferences.plistsonlz4
                            -irefox cookies
                                name: Clear Safari preferences for downloads, geolocation, pop-ups, and autoplay per site
                                docs: https://blog.d204n6.com/2020/09/macos-safari-preferences-and-privacy.html
                                code: rm -f ~/Library/Safari/PerSitePreferences.db.sqlite
                    --fv ~/Library/Application\ Support/Firefox/Profiles/*/cookies.sqlite-shm
                        category: Clear Firefox history/Firefox/Profiles/*/cookies.sqlite-wal
                        children:ry/Application\ Support/Firefox/Profiles/*/storage/default/http*
                            --party application data
                                name: Clear Firefox cache
                                code: |- data
                                    sudo rm -rf ~/Library/Caches/Mozilla/
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/netpredictions.sqlite
                            -
                                name: Clear Firefox form historyy the privacy.sexy desktop application,
                                code: |-ivacy by eliminating all traces of use.
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/formhistory.sqlite
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/formhistory.dat[1],
                            -y is applicable to desktop application users only.
                                name: Clear Firefox site preferences
                                code: rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/content-prefs.sqliteir systems.
                            -
                                name: Clear Firefox session restore data (loads after the browser closes or crashes)
                                code: |- affect security [2] and troubleshooting [1]:
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionCheckpoints.json
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore*.js*f needed.
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore.bak*
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore-backups/previous.js*op vs. Web Features | privacy.sexy | github.com"
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore-backups/recovery.js*hub.com"
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore-backups/recovery.bak*
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore-backups/previous.bak*
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/sessionstore-backups/upgrade.js*-20*
                            - removes script files generated by the privacy.sexy desktop application.
                                name: Clear Firefox passwords
                                docs: https://web.archive.org/web/20210425202923/http://kb.mozillazine.org/Password_Manager
                                code: |-nd security [2].
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/signons.txt
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/signons2.txt ensuring that there is no
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/signons3.txt
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/signons.sqlite
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/logins.json
                            -tion is irreversible. Deleted script files cannot be retrieved.
                                name: Clear Firefox HTML5 cookieshooting if you experience issues after using privacy.sexy scripts.
                                code: rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/webappsstore.sqlite
                            -//github.com/undergroundwires/privacy.sexy/blob/master/docs/desktop/desktop-vs-web-features.md "Desktop vs. Web Features | privacy.sexy | github.com"
                                name: Clear Firefox crash reportsy.sexy/blob/master/SECURITY.md "SECURITY.md  | privacy.sexy | github.com"
                                code: |-
                                    rm -rfv ~/Library/Application\ Support/Firefox/Crash\ Reports/
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/minidumps/*.dmp
                            -Glob: "$HOME/Library/Application Support/privacy.sexy/runs"
                                name: Clear Firefox backup files
                                code: |-
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/bookmarkbackups/*.json
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/bookmarkbackups/*.jsonlz4
                            -rom the web version, the desktop application records logs for troubleshooting [1].
                                name: Clear Firefox cookiesnd transparency for security [2].
                                code: |-
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/cookies.txt the application's activities
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/cookies.sqlite
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/cookies.sqlite-shm
                                    rm -fv ~/Library/Application\ Support/Firefox/Profiles/*/cookies.sqlite-wal
                                    rm -rfv ~/Library/Application\ Support/Firefox/Profiles/*/storage/default/http*lpful in diagnosing issues.
            -     > - Logs can contain valuable information for technical support should you need assistance.
                category: Clear third-party application data
                children:tps://github.com/undergroundwires/privacy.sexy/blob/master/docs/desktop/desktop-vs-web-features.md "Desktop vs. Web Features | privacy.sexy | github.com"
                    -: https://github.com/undergroundwires/privacy.sexy/blob/master/SECURITY.md "SECURITY.md  | privacy.sexy | github.com"
                        category: Clear privacy.sexy data
                        # Marked: refactor-with-variables, refactor-with-partials
                        #   - Documentation is same across macOS, Linux and Windows, this should be shared and not duplicated.
                        docs: |-b: "$HOME/Library/Logs/privacy.sexy"
                            This category offers scripts to remove data left by the privacy.sexy desktop application,
                            helping you ensure your privacy by eliminating all traces of use.
            code: sudo rm -rfv ~/Library/Application\ Support/Adobe/Common/Media\ Cache\ Files/* &>/dev/null
                            The web application version of privacy.sexy does not create or store user data on your device [1],
                            so this category is applicable to desktop application users only.
            code: |-
                            These scripts are designed for anyone wanting to ensure their script activities leave no trace on their systems.
                  rm -rfv ~/.gradle/caches/ &> /dev/null
                            > **Caution**:
                            > Deleting this data might affect security [2] and troubleshooting [1]:
                            > - Logs are valuable for diagnosing issues and understanding past actions [1].
                            > - Script files can help review changes made to the system and aid in reverting those changes if needed.
              if [ -d "~/Dropbox/.dropbox.cache" ]; then
                            [1]: https://github.com/undergroundwires/privacy.sexy/blob/master/docs/desktop/desktop-vs-web-features.md "Desktop vs. Web Features | privacy.sexy | github.com"
                            [2]: https://github.com/undergroundwires/privacy.sexy/blob/master/SECURITY.md "SECURITY.md  | privacy.sexy | github.com"
                        children:ive File Stream cache
                            -rd
                                name: Clear privacy.sexy script history
                                docs: |- Stream"
                                    This script removes script files generated by the privacy.sexy desktop application.
          - name: Clear Composer cache
                                    The desktop version executes scripts directly on your device [1], saving a script file for execution [1],
                                    troubleshooting [1], and security [2].
              if type "composer" &> /dev/null; then
                                    By running this script, you remove the executed script files, enhancing your privacy by ensuring that there is no
                                    residual data that could reveal your usage patterns or preferences.
          - name: Clear Homebrew cache
                                    > **Caution**:
                                    > - This action is irreversible. Deleted script files cannot be retrieved.
                                    > - These files might be necessary for troubleshooting if you experience issues after using privacy.sexy scripts.
                  brew cleanup -s &>/dev/null
                                    [1]: https://github.com/undergroundwires/privacy.sexy/blob/master/docs/desktop/desktop-vs-web-features.md "Desktop vs. Web Features | privacy.sexy | github.com"
                                    [2]: https://github.com/undergroundwires/privacy.sexy/blob/master/SECURITY.md "SECURITY.md  | privacy.sexy | github.com"
                                call:
                                    function: ClearDirectoryContents
                                    parameters:
                                        directoryGlob: "$HOME/Library/Application Support/privacy.sexy/runs"
                            -> /dev/null; then
                                name: Clear privacy.sexy activity logs
                                docs: |-
                                    This script removes log files generated by the privacy.sexy desktop application.
            recommend: strict
                                    Different from the web version, the desktop application records logs for troubleshooting [1].
                                    Additionally, these logs offer auditing and transparency for security [2].

                                    Deleting these logs can help maintain your privacy by ensuring there are no records of the application's activities
                                    on your system. is stopped, its filesystem remains intact, and potentially sensitive data inside
              it can be accessed. By removing stopped containers, we eliminate this potential privacy risk.
                                    > **Caution**:
                                    > - Removing logs will prevent you from reviewing the application's activities, which could be helpful in diagnosing issues.
                                    > - Logs can contain valuable information for technical support should you need assistance. unused
              images ensures that any inadvertent sensitive information embedded in those images is eradicated.
                                    [1]: https://github.com/undergroundwires/privacy.sexy/blob/master/docs/desktop/desktop-vs-web-features.md "Desktop vs. Web Features | privacy.sexy | github.com"
                                    [2]: https://github.com/undergroundwires/privacy.sexy/blob/master/SECURITY.md "SECURITY.md  | privacy.sexy | github.com"
                                call:re, inter-container communication, or even hardcoded secrets. Removing unused networks mitigates
                                    function: ClearDirectoryContents configurations.
                                    parameters:
                                        directoryGlob: "$HOME/Library/Logs/privacy.sexy"o speed up image creation. This cache can contain
                    -s of previous builds, including potentially sensitive data or files. Pruning the build cache ensures that these remnants
                        name: Clear Adobe cache privacy.
                        recommend: standard
                        code: sudo rm -rfv ~/Library/Application\ Support/Adobe/Common/Media\ Cache\ Files/* &>/dev/null on the system is
                    -. This makes it harder for malicious actors to exploit any lingering or overlooked vulnerabilities in the system or Docker
                        name: Clear Gradle cache
                        recommend: strict
                        code: |-docker system prune -af` command to clean up unused Docker data [1].
                            if [ -d "~/.gradle/caches" ]; then
                                rm -rfv ~/.gradle/caches/ &> /dev/null
                            fi
                    -e all stopped containers.
                        name: Clear Dropbox cachet least one container.
                        recommend: standardby any container.
                        code: |- cache.
                            if [ -d "~/Dropbox/.dropbox.cache" ]; then
                                sudo rm -rfv ~/Dropbox/.dropbox.cache/* &>/dev/nullom/engine/reference/commandline/system_prune/ "docker system prune | Docker Documentation"
                            fi
                    - "docker" &> /dev/null; then
                        name: Clear Google Drive File Stream cache
                        recommend: standard
                        code: |-rtualenv cache
                            killall "Google Drive File Stream"
                            rm -rfv ~/Library/Application\ Support/Google/DriveFS/[0-9a-zA-Z]*/content_cache &>/dev/null
                    -PYENV_VIRTUALENV_CACHE_PATH" ]; then
                        name: Clear Composer cachePATH &>/dev/null
                        recommend: strict
                        code: |-e
                            if type "composer" &> /dev/null; then
                                composer clearcache &> /dev/null
                            fi /dev/null; then
                    - cache clean --force
                        name: Clear Homebrew cache
                        recommend: strict
                        code: |-
                            if type "brew" &>/dev/null; then
                                brew cleanup -s &>/dev/null
                                rm -rfv $(brew --cache) &>/dev/null
                                brew tap --repair &>/dev/null
                            fi
                    -ar iOS usage data
                        name: Clear old Ruby gem versions
                        recommend: strictom iTunes
                        code: |-
                            if type "gem" &> /dev/null; thene\ Applications/* &>/dev/null
                                gem cleanup &>/dev/null
                            fid
                    --rf ~/Pictures/iPhoto\ Library/iPod\ Photo\ Cache/*
                        name: Clear unused Docker data
                        recommend: strict
                        docs: |-ary/Application\ Support/MobileSync/Backup/* &>/dev/null
                            This script frees up disk space, but also improves user privacy by:
            recommend: strict
                            1. **Removal of stopped containers**: Containers often run applications or services that might process sensitive
                            or personal data. Even if a container is stopped, its filesystem remains intact, and potentially sensitive data inside
                            it can be accessed. By removing stopped containers, we eliminate this potential privacy risk.
                  osascript -e 'tell application "iOS Simulator" to quit'
                            2. **Deletion of unused images**: Images can sometimes contain sensitive information, especially if they were built
                            from `Dockerfile`s that copied local files or were used in scenarios where sensitive data was processed. Deleting unused
                            images ensures that any inadvertent sensitive information embedded in those images is eradicated.
              fi
                            3. **Cleanup of network configurations**: Networks, especially custom ones, can contain configurations that reveal details
                            about system architecture, inter-container communication, or even hardcoded secrets. Removing unused networks mitigates
                            risks associated with lingering, outdated, or insecure configurations.
              sudo defaults delete /Users/$USER/Library/Preferences/com.apple.iPod.plist "conn:128:Last Connect"
                            4. **Elimination of build cache**: The Docker build process uses a cache to speed up image creation. This cache can contain
                            remnants of previous builds, including potentially sensitive data or files. Pruning the build cache ensures that these remnants
                            are deleted, further safeguarding privacy..plist Devices
              sudo rm -rfv /var/db/lockdown/*
                            5. **Footprint reduction**: By consistently pruning unused Docker objects, the overall footprint of Docker on the system is
                            reduced. This makes it harder for malicious actors to exploit any lingering or overlooked vulnerabilities in the system or Docker
                            itself.
          rm -rfv ~/Library/Developer/Xcode/DerivedData/* &>/dev/null
                            This script runs `docker system prune -af` command to clean up unused Docker data [1].
          rm -rfv ~/Library/Developer/Xcode/iOS Device Logs/* &>/dev/null
                            Specifically, the command will [1]:
        recommend: standard
                            - Remove all stopped containers.
                            - Remove all networks not used by at least one container.
                            - Remove all images not used by any container.
                            - Remove all build cache.
        recommend: standard
                            [1]: https://web.archive.org/web/20230810171526/https://docs.docker.com/engine/reference/commandline/system_prune/ "docker system prune | Docker Documentation"
                        code: |-ion privacy permissions
                            if type "docker" &> /dev/null; then
                                docker system prune -afcy permissions for a variety of applications on your device,
                            fitablish control over your personal data. Each script targets a specific permission type ‚Äì such
                    -microphone, contacts, or accessibility services ‚Äì enabling you to revoke permissions that have previously
                        name: Clear Pyenv-Virtualenv cache
                        recommend: strict
                        code: |-missions, you not only enhance your privacy but also improve your device's security. After
                            if [ "$PYENV_VIRTUALENV_CACHE_PATH" ]; thent permission again to access these services or
                                rm -rfv $PYENV_VIRTUALENV_CACHE_PATH &>/dev/null like your camera or access your contacts,
                            fio grant or deny permission. It's a proactive step to ensure that your sensitive information
                    -ervices are accessed only with your current and informed consent.
                        name: Clear NPM cache
                        recommend: strictrchive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services
                        code: |-* permissions
                            if type "npm" &> /dev/null; then
                                npm cache clean --forceplications.
                            fireviously granted permissions, enhancing privacy and security by ensuring no application has unauthorized access to system services or user data.
                    -
                        name: Clear Yarn caches
                        recommend: strict
                        code: |-
                            if type "yarn" &> /dev/null; then
                                echo 'Cleanup Yarn Cache...'
                                yarn cache clean --forceaccess [1].
                            fiplication can access the system camera without explicit user permission, protecting against unauthorized surveillance and data breaches.
            -
                category: Clear iOS usage data24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                children:
                    -n: ResetServicePermissions
                        name: Clear iOS app copies from iTunes
                        recommend: strict
                        code: rm -rfv ~/Music/iTunes/iTunes\ Media/Mobile\ Applications/* &>/dev/null
                    -
                        name: Clear iOS photo cachecrophone access [1].
                        recommend: standard to the microphone, protecting against eavesdropping and unauthorized audio recording by applications.
                        code: rm -rf ~/Pictures/iPhoto\ Library/iPod\ Photo\ Cache/*
                    -tps://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        name: Clear iOS Device Backups
                        recommend: strictssions
                        code: rm -rfv ~/Library/Application\ Support/MobileSync/Backup/* &>/dev/null
                    -ceId: Microphone
                        name: Clear iOS simulatorss
                        recommend: strict
                        code: |- permissions for accessibility features [1].
                            if type "xcrun" &>/dev/null; thenservices, preventing misuse and ensuring these features are used only with user consent.
                                osascript -e 'tell application "com.apple.CoreSimulator.CoreSimulatorService" to quit'
                                osascript -e 'tell application "iOS Simulator" to quit'umentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                                osascript -e 'tell application "Simulator" to quit'
                                xcrun simctl shutdown all
                                xcrun simctl erase all
                            fiessibility
                    -ar "Screen Capture" permissions
                        name: Clear list of connected iOS devices
                        recommend: strictons for screen capture [1].
                        code: |-tions cannot capture screen content without user authorization, protecting sensitive information displayed on the screen.
                            sudo defaults delete /Users/$USER/Library/Preferences/com.apple.iPod.plist "conn:128:Last Connect"
                            sudo defaults delete /Users/$USER/Library/Preferences/com.apple.iPod.plist Devicesment/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            sudo defaults delete /Library/Preferences/com.apple.iPod.plist "conn:128:Last Connect"
                            sudo defaults delete /Library/Preferences/com.apple.iPod.plist Devices
                            sudo rm -rfv /var/db/lockdown/*
            -   serviceId: ScreenCapture
                name: Clear Xcode's derived data and archives
                recommend: strict
                code: |-t resets permissions for accessing reminders information managed by the Reminders app [1].
                    rm -rfv ~/Library/Developer/Xcode/DerivedData/* &>/dev/nullthout explicit user permission, maintaining the privacy of personal reminders.
                    rm -rfv ~/Library/Developer/Xcode/Archives/* &>/dev/null
                    rm -rfv ~/Library/Developer/Xcode/iOS Device Logs/* &>/dev/null/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
            -all:
                name: Clear DNS cacheermissions
                recommend: standard
                code: |-d: Reminders
                    sudo dscacheutil -flushcache
                    sudo killall -HUP mDNSResponder
            - This script resets permissions for accessing the pictures managed by the Photos app [1].
                name: Clear inactive memoryanted to applications, safeguarding personal photos and media from unauthorized access.
                recommend: standard
                code: sudo purgeve.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
            -all:
                category: Clear application privacy permissions
                docs: |-:
                    This category provides scripts to reset privacy permissions for a variety of applications on your device,
                    helping you to re-establish control over your personal data. Each script targets a specific permission type ‚Äì such
                    as camera, microphone, contacts, or accessibility services ‚Äì enabling you to revoke permissions that have previously
                    been granted to applications.accessing the calendar information managed by the Calendar app [1].
              It ensures that applications cannot access calendar data without user consent, protecting personal and sensitive calendar information.
                    By resetting these permissions, you not only enhance your privacy but also improve your device's security. After
                    running these scripts, applications will require your explicit permission again to access these services orrencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                    information. This means the next time an app attempts to use a service like your camera or access your contacts,
                    you'll be prompted to grant or deny permission. It's a proactive step to ensure that your sensitive information
                    or system services are accessed only with your current and informed consent.
                children:: Calendar
                    # Main documentation: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services
                    -
                        name: Clear **"All"** permissionsk access.
                        docs: |-llows the application access to all protected files, including system administration files [1].
                            This script resets all permissions for applications.cing the risk of data exposure and enhancing overall system security.
                            It revokes all previously granted permissions, enhancing privacy and security by ensuring no application has unauthorized access to system services or user data.
                        call:chive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            function: ResetServicePermissions
                            parameters:missions
                                serviceId: All
                    -ceId: SystemPolicyAllFiles
                        name: Clear "Camera" permissions
                        docs: |-
                            This script resets permissions for camera access [1].
                            It ensures no application can access the system camera without explicit user permission, protecting against unauthorized surveillance and data breaches.
              It ensures that applications cannot access the user's contact list without explicit permission, maintaining the confidentiality of personal contacts.
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:chive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            function: ResetServicePermissions
                            parameters:missions
                                serviceId: Camera
                    -ceId: AddressBook
                        name: Clear "Microphone" permissions
                        docs: |-
                            This script resets permissions for microphone access [1].
                            It revokes all granted access to the microphone, protecting against eavesdropping and unauthorized audio recording by applications.

                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:
                                serviceId: Microphone
                    -ar "Documents Folder" permissions
                        name: Clear "Accessibility" permissions
                        docs: |- permissions for accessing the Documents folder [1].
                            This script resets permissions for accessibility features [1].nsent, safeguarding important and private documents.
                            It revokes application access to accessibility services, preventing misuse and ensuring these features are used only with user consent.
              [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:ServicePermissions
                            function: ResetServicePermissions
                            parameters:DocumentsFolder
                                serviceId: Accessibility
                    -
                        name: Clear "Screen Capture" permissionsownloads folder [1].
                        docs: |-plications cannot access downloaded files without user authorization, protecting downloaded content from misuse.
                            This script resets permissions for screen capture [1].
                            It ensures applications cannot capture screen content without user authorization, protecting sensitive information displayed on the screen.ferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
            call:
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:permissions
                                serviceId: ScreenCapture
                    -ript resets permissions for Apple Events [1].
                        name: Clear "Reminders" permissionsnd restricted Apple Events to other processes [1], enhancing privacy and security.
                        docs: |-
                            This script resets permissions for accessing reminders information managed by the Reminders app [1].encespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            It ensures applications cannot access or modify reminders data without explicit user permission, maintaining the privacy of personal reminders.
              function: ResetServicePermissions
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:pleEvents
                            function: ResetServicePermissions
                            parameters:
                                serviceId: Reminderse Provider Presence [1].
                    -kes the ability of File Provider applications to know when the user is accessing their managed files [1], enhancing user privacy.
                        name: Clear "Photos" permissions
                        docs: |-ve.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            This script resets permissions for accessing the pictures managed by the Photos app [1].
                            It revokes all permissions granted to applications, safeguarding personal photos and media from unauthorized access.
              parameters:
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:en Events" permissions
                            function: ResetServicePermissions
                            parameters:nEvent" permissions [1].
                                serviceId: Photossten to system events [1], preventing unauthorized monitoring of user interactions with the system.
                    -
                        name: Clear "Calendar" permissionstps://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        docs: |-
                            This script resets permissions for accessing the calendar information managed by the Calendar app [1].
                            It ensures that applications cannot access calendar data without user consent, protecting personal and sensitive calendar information.
                serviceId: ListenEvent
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissionse Media Library [1].
                            parameters:ons cannot access Apple Music, music and video activity, and the media library [1] without user consent.
                                serviceId: Calendar
                    -tps://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        name: Clear "Full Disk Access" permissions
                        docs: |-vicePermissions
                            This script resets permissions for full disk access.
                            Full disk access allows the application access to all protected files, including system administration files [1].
                            It revokes broad file access from applications, significantly reducing the risk of data exposure and enhancing overall system security.
            docs: |-
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:lications from using CoreGraphics APIs to send system events [1], safeguarding against potential misuse.
                            function: ResetServicePermissions
                            parameters:023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                                serviceId: SystemPolicyAllFiles
                    -n: ResetServicePermissions
                        name: Clear "Contacts" permissions
                        docs: |-vent
                            This script resets permissions for accessing contacts.
                            The contact information managed by the Contacts app [1].
                            It ensures that applications cannot access the user's contact list without explicit permission, maintaining the confidentiality of personal contacts.
              This script resets permissions for using Speech Recognition [1].
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            parameters:
                                serviceId: AddressBook
                    -ers:
                        name: Clear "Desktop Folder" permissions
                        docs: |-ification" permissions
                            This script resets permissions for accessing the Desktop folder [1].
                            It revokes application access to files on the desktop, protecting personal and work-related documents from unauthorized access.
              It prevents applications from updating or deleting other apps [1], maintaining system integrity and user control.
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:chive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            function: ResetServicePermissions
                            parameters:missions
                                serviceId: SystemPolicyDesktopFolder
                    -ceId: SystemPolicyAppBundles
                        name: Clear "Documents Folder" permissions
                        docs: |-
                            This script resets permissions for accessing the Documents folder [1].
                            It prevents applications from accessing files in this folder without user consent, safeguarding important and private documents.

                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:
                                serviceId: SystemPolicyDocumentsFolder
                    -ar "Network Volumes" permissions
                        name: Clear "Downloads Folder" permissions
                        docs: |- permissions for accessing files on network volumes [1].
                            This script resets permissions for accessing the Downloads folder [1].
                            It ensures that applications cannot access downloaded files without user authorization, protecting downloaded content from misuse.
              [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:ServicePermissions
                            function: ResetServicePermissions
                            parameters:NetworkVolumes
                                serviceId: SystemPolicyDownloadsFolder
                    -
                        name: Clear "Apple Events" permissionses on removable volumes [1].
                        docs: |-n external drives from unauthorized application access.
                            This script resets permissions for Apple Events [1].
                            It revokes permissions for applications to send restricted Apple Events to other processes [1], enhancing privacy and security. "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
            call:
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:tration Files" permissions
                                serviceId: AppleEvents
                    -ript resets permissions for accessing system administration files [1].
                        name: Clear "File Provider Presence" permissionsess to critical system files.
                        docs: |-
                            This script resets permissions for File Provider Presence [1].ntation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                            It revokes the ability of File Provider applications to know when the user is accessing their managed files [1], enhancing user privacy.
              function: ResetServicePermissions
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:stemPolicySysAdminFiles
                            function: ResetServicePermissionser" as "Guest User"
                            parameters:
                                serviceId: FileProviderPresence
                    - removes the built-in Guest User account from macOS to prevent unauthorized access.
                        name: Clear "Listen Events" permissions
                        docs: |- lets anyone access your Mac without requiring a password or user account [1].
                            This script resets "ListenEvent" permissions [1].m settings [1].
                            It revokes application access to listen to system events [1], preventing unauthorized monitoring of user interactions with the system.
          Any files created by a Guest User are stored in a temporary folder, which is deleted when the guest logs out [1].
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissionsecurity by:
                            parameters:
                                serviceId: ListenEvent your Mac [2]
                    -ng a potential entry point for attackers
                        name: Clear "Media Library" permissionsrs [2] [3]
                        docs: |-
                            This script resets permissions for accessing the Media Library [1].urity guidelines [2] [3]
                            It ensures that applications cannot access Apple Music, music and video activity, and the media library [1] without user consent.

                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissionsser before removing it:
                            parameters:
                                serviceId: MediaLibraryt accessing your personal data [4]
                    -ate your Mac if lost through the **Find My** app when someone uses Safari as guest [1]
                        name: Clear "Post Event" permissions activity is automatically deleted upon logout [1] [4]
                        docs: |-ions needing to provide temporary access [4]
                            This script resets permissions for sending "PostEvent" [1].
                            It prevents applications from using CoreGraphics APIs to send system events [1], safeguarding against potential misuse.
          This script only removes the Guest User account.
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:emoves the ability to let others use the device without exposing personal data
                                serviceId: PostEventur Mac through **Find My** when someone uses Safari as guest
                    -
                        name: Clear "Speech Recognition" permissions
                        recommend: strict
                        docs: |-
                            This script resets permissions for using Speech Recognition [1].
                            It revokes application access to the speech recognition facility and sending speech data to Apple [1], protecting user privacy.
            `sysadminctl` is a macOS tool that controls user accounts [2].
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:ool to manage FileVault and its users [8].
                            function: ResetServicePermissionsileVault [8].
                            parameters:ers/Guest` to delete the Guest User directory [9].
                                serviceId: SpeechRecognition built-in on macOS [9].
                    -
                        name: Clear "App Modification" permissionst.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                        docs: |-ve.org/web/20241125024856/https://ss64.com/mac/sysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                            This script resets permissions for modifying other apps [1].g/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                            It prevents applications from updating or deleting other apps [1], maintaining system integrity and user control.n-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
          [5]: https://archive.ph/2025.01.12-200100/https://gist.github.com/justinpawela/8a924f36f86bac2b563bf6832eefff25?permalink_comment_id=1893323%23gistcomment-1893323 "Comment | Disable macOS Guest user account script | gist.github.com"
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:e.ph/2025.01.12-224816/https://stevenesser.com/posts/macos-cheatsheet/ "MacOS Cheatsheet | stevenesser.com"
                            function: ResetServicePermissionsps://www.manpagez.com/man/8/fdesetup/ "man page fdesetup section 8 | www.manpagez.com"
                            parameters:web/20250112224606/https://ss64.com/mac/dscl.html "dscl Man Page - macOS - SS64.com | ss64.com"
                                serviceId: SystemPolicyAppBundles
                    - RunIfCommandExists
                        name: Clear "Application Data" permissions
                        docs: |-tl
                            This script resets permissions for accessing application data [1].
                            It revokes application access to specific application data, enhancing privacy and data security.
            parameters:
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:etup remove -user Guest
                            function: ResetServicePermissions
                            parameters:
                                serviceId: SystemPolicyAppData
                    -udo dscl . delete /Users/Guest
                        name: Clear "Network Volumes" permissions
                        docs: |-
                            This script resets permissions for accessing files on network volumes [1].
                            It ensures applications cannot access network files without user authorization.
        docs: https://github.com/privacysexy-forks/policy-templates/blob/master/README.md
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:licies so the telemetry can be configured.
                            function: ResetServicePermissionsa.firefox EnterprisePoliciesEnabled -bool TRUE
                            parameters:
                                serviceId: SystemPolicyNetworkVolumesx DisableTelemetry -bool TRUE
                    --
                        name: Clear "Removable Volumes" permissionsefox EnterprisePoliciesEnabled
                        docs: |-Library/Preferences/org.mozilla.firefox DisableTelemetry
                            This script resets permissions for accessing files on removable volumes [1].
                            It protects data on external drives from unauthorized application access.
        code: defaults write com.microsoft.office DiagnosticDataTypePreference -string ZeroDiagnosticData
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:oftware Update service
                            function: ResetServicePermissions
                            parameters:
                                serviceId: SystemPolicyRemovableVolumesSoftwareUpdate.bundle/Contents/Resources/ksinstall
                    -oogleUpdateFile" ]; then
                        name: Clear "System Administration Files" permissions
                        docs: |-Google update'
                            This script resets permissions for accessing system administration files [1].
                            It enhances system security by restricting application access to critical system files.
          fi
                            [1]: https://archive.ph/2023.11.24-170934/https://developer.apple.com/documentation/devicemanagement/privacypreferencespolicycontrol/services "PrivacyPreferencesPolicyControl.Services | Apple Developer Documentation | apple.com"
                        call:
                            function: ResetServicePermissions
                            parameters:
                                serviceId: SystemPolicySysAdminFiles
            -arameters:
                name: Remove Guest User # Apple capitalizes "guest user" as "Guest User"
                recommend: strictI telemetry
                docs: |-ard
                    This script removes the built-in Guest User account from macOS to prevent unauthorized access.
          - function: PersistUserEnvironmentConfiguration
                    The Guest User feature lets anyone access your Mac without requiring a password or user account [1].
                    Guest users cannot log in remotely and have limited access to system settings [1].
                    Guests have limited privileges and cannot change system settings or access encrypted disks (when FileVault is enabled) [1].
                    Any files created by a Guest User are stored in a temporary folder, which is deleted when the guest logs out [1].
                    Despite these limitations, the Guest account poses privacy and security risks.
        call:
                    Removing the Guest User improves your privacy and security by:
            parameters:
                    - Preventing unauthorized physical access to your Mac [2]
                    - Eliminating a potential entry point for attackers
                    - Restricting system access to only authenticated users [2] [3]
          Parallels Desktop for Mac is software providing hardware virtualization for macOS [1].
                    The U.S. Department of Defense recommends disabling guest access as part of their security guidelines [2] [3]
                    This aligns with the principle that only authorized individuals should have access to system components [3].
          data include IP address of your device, your broad geographical location (country, state
                    Removing the Guest User eliminates temporary files and configurations, freeing up disk space.

                    However, consider these benefits of keeping Guest User before removing it:fault.
          Both of these behaviors communicate with online services that reveal personal data about you.
                    - Lets others temporarily use your Mac without accessing your personal data [4]
                    - Helps locate your Mac if lost through the **Find My** app when someone uses Safari as guest [1]rallels Desktop for Mac - Wikipedia | en.wikipedia.org"
                    - Creates an isolated environment where some guest activity is automatically deleted upon logout [1] [4]| parallels.com"
                    - Useful for organizations needing to provide temporary access [4]422 "How do I turn off notifications in Parallels Desktop and Parallels Access? | Knowledge Base | parallels.com"
          [4]: https://web.archive.org/web/20221012151953/http://download.parallels.com/stm/docs/en/Parallels_Desktop_Users_Guide/22220.htm "Automatic Updating | Parallels Desktop Users Guide | download.parallels.com"
                    **Note:**
                    This script only removes the Guest User account.
                    For complete guest access removal (including sharing features), use additional related scripts.
            docs: |-
                    > **Caution:**-product notifications to show ads from Parallels or other third
                    > - Removing the Guest User removes the ability to let others use the device without exposing personal data
                    > - This disables the ability to locate your Mac through **Find My** when someone uses Safari as guest
              The main setting is `ProductPromo.ForcePromoOff` [1] that you can check using:
                    ### Technical Details
              1. `defaults read 'com.parallels.Parallels Desktop' 'ProductPromo.ForcePromoOff'`
                    This script:'com.parallels.Parallels Desktop' 'WelcomeScreenPromo.PromoOff'`

                    - Uses `sysadminctl` with `-deleteUser Guest` to disable the guest account [2]
                      `sysadminctl` is a macOS tool that controls user accounts [2].
                    - Runs `fdesetup remove -user Guest` to remove Guest from the FileVault Boot Menu [5] [6] [7].
                      `fdesetup` is a tool to manage FileVault and its users [8].
                      `remove -user` option removes enabled user from FileVault [8].
                    - Executes `dscl . delete /Users/Guest` to delete the Guest User directory [9].nable-to-process-the-upgrade-request.345603/ "Unable to process the upgrade request | Parallels Forums | forum.parallels.com"
                      `dscl` is Directory Service command line utility built-in on macOS [9]. "How do I turn off notifications in Parallels Desktop and Parallels Access? | Knowledge Base | parallels.com"
            code: |-
                    [1]: https://archive.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                    [2]: https://web.archive.org/web/20241125024856/https://ss64.com/mac/sysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                    [3]: https://web.archive.org/web/20241125172444/https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                    [4]: https://web.archive.org/web/20241008165805/https://www.hexnode.com/mobile-device-management/help/script-to-enable-guest-user-on-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
                    [5]: https://archive.ph/2025.01.12-200100/https://gist.github.com/justinpawela/8a924f36f86bac2b563bf6832eefff25?permalink_comment_id=1893323%23gistcomment-1893323 "Comment | Disable macOS Guest user account script | gist.github.com"
                    [6]: https://web.archive.org/web/20240301155136/https://www.techradar.com/how-to/macos-1013-high-sierra-problems-how-to-fix-them "macOS 10.13 High Sierra problems: how to fix them | TechRadar | www.techradar.com"
                    [7]: https://archive.ph/2025.01.12-224816/https://stevenesser.com/posts/macos-cheatsheet/ "MacOS Cheatsheet | stevenesser.com"
                    [8]: https://web.archive.org/web/20241125030134/https://www.manpagez.com/man/8/fdesetup/ "man page fdesetup section 8 | www.manpagez.com"
                    [9]: https://web.archive.org/web/20250112224606/https://ss64.com/mac/dscl.html "dscl Man Page - macOS - SS64.com | ss64.com"
                call:
                    -tps://web.archive.org/web/20221012151953/http://download.parallels.com/stm/docs/en/Parallels_Desktop_Users_Guide/22220.htm "Automatic Updating | Parallels Desktop Users Guide | download.parallels.com"
                        function: RunIfCommandExists012155829/https://www.parallels.com/about/legal/privacy/ "Privacy Statement | parallels.com"
                        parameters:
                            command: sysadminctls for Parallels Desktop updates
                            code: sudo sysadminctl -deleteUser Guest
                    -omatic downloads are enabled by default, and this script disables automatic downloads.
                        function: RunIfCommandExists
                        parameters:ds are configured using the `Application preferences.Download updates automatically` property [1].
                            command: fdesetup
                            code: sudo fdesetup remove -user Guest Desktop' 'Application preferences.Download updates automatically'`
                    -alues: 0 - Disabled, 1 - Enabled (default)
                        function: RunIfCommandExists
                        parameters:archive.org/web/20221012153810/https://download.parallels.com/desktop/v18/docs/en_US/Parallels-Desktop-Business-Edition-Administrators-Guide/37744.htm "Parallels Desktop Business Edition Administrator's Guide v18 - Configuring individual Macs | download.parallels.com"
                            command: dscl.parallels.Parallels Desktop' 'Application preferences.Download updates automatically' -bool no
                            code: sudo dscl . delete /Users/Guestls Desktop' 'Application preferences.Download updates automatically' -bool yes
    -         - name: Disable automatic checks for Parallels Desktop updates
        category: Configure programs
        children: Automatic checks are weekly by default, and this script disables the checks completely.
            -
                name: Disable Firefox telemetrys can be configured using `Application preferences.Check for updates` property [1].
                recommend: standard
                docs: https://github.com/privacysexy-forks/policy-templates/blob/master/README.mdces.Check for updates'`
                code: |-es: 0 - Never, 1 - Once a day, 2 - Once a week (default), 3 - Once a month
                    # Enable Firefox policies so the telemetry can be configured.
                    sudo defaults write /Library/Preferences/org.mozilla.firefox EnterprisePoliciesEnabled -bool TRUEUS/Parallels-Desktop-Business-Edition-Administrators-Guide/37744.htm "Parallels Desktop Business Edition Administrator's Guide v18 - Configuring individual Macs | download.parallels.com"
                    # Disable sending usage dataels.Parallels Desktop' 'Application preferences.Check for updates' -int 0
                    sudo defaults write /Library/Preferences/org.mozilla.firefox DisableTelemetry -bool TRUEfor updates' -int 2
                revertCode: |-
                    sudo defaults delete /Library/Preferences/org.mozilla.firefox EnterprisePoliciesEnabled
                    sudo defaults delete /Library/Preferences/org.mozilla.firefox DisableTelemetry
            -ren:
                name: Disable Microsoft Office telemetry
                recommend: standard
                code: defaults write com.microsoft.office DiagnosticDataTypePreference -string ZeroDiagnosticDataeactivate -stop
                revertCode: defaults delete com.microsoft.office DiagnosticDataTypePreferencents/Resources/kickstart -activate -restart -agent -console
            -ame: Remove Apple Remote Desktop Settings
                name: Remove Google Software Update service
                recommend: strict
                code: |-f /var/db/RemoteManagement
                    googleUpdateFile=~/Library/Google/GoogleSoftwareUpdate/GoogleSoftwareUpdate.bundle/Contents/Resources/ksinstall
                    if [ -f "$googleUpdateFile" ]; then.apple.RemoteDesktop.plist
                        $googleUpdateFile --nukeSupport/Apple/Remote\ Desktop/
                        echo 'Uninstalled Google update'e\ Desktop/
                    elsebrary/Containers/com.apple.RemoteDesktop
                        echo 'Google update file does not exist'
                    fi write NSGlobalDomain WebAutomaticSpellingCorrectionEnabled -bool false
            -tCode: defaults delete NSGlobalDomain WebAutomaticSpellingCorrectionEnabled
                name: Disable Homebrew user behavior analytics
                recommend: standard
                docs: https://docs.brew.sh/Analytics off
                call:udo systemsetup -setremoteappleevents on
                    - automatic storage of documents in iCloud Drive
                        function: PersistUserEnvironmentConfigurationmentstocloud.html
                        parameters:
                            configuration: export HOMEBREW_NO_ANALYTICS=1loud -bool false
            -tCode: defaults delete NSGlobalDomain NSDocumentSaveNewDocumentsToCloud
                name: Disable NET Core CLI telemetry on Dock
                recommend: standardle.com/documentation/devicemanagement/dock
                call:s write com.apple.dock show-recents -bool false
                    -efaults delete com.apple.dock show-recents
                        function: PersistUserEnvironmentConfiguration
                        parameters:
                            configuration: export DOTNET_CLI_TELEMETRY_OPTOUT=1
            -tCode: defaults write com.apple.NetworkBrowser DisableAirDrop -bool false
                name: Disable PowerShell Core telemetry
                recommend: standard
                docs: https://github.com/privacysexy-forks/PowerShell/blob/v7.1.5/README.md#telemetry
                call:: standard
                    -aults write com.apple.assistant.support 'Siri Data Sharing Opt-In Status' -int 2
                        function: PersistUserEnvironmentConfigurationSiri Data Sharing Opt-In Status'
                        parameters:
                            configuration: export POWERSHELL_TELEMETRY_OPTOUT=1
            - - name: Disable "Ask Siri"
                category: Configure Parallels Desktop
                docs: |-tps://derflounder.wordpress.com/2016/09/20/blocking-siri-on-macos-sierra/
                    Parallels Desktop for Mac is software providing hardware virtualization for macOS [1].
                revertCode: defaults write com.apple.assistant.support 'Assistant Enabled' -bool true
                    When you use it, it collects and shares your personal data to third parties [2]. Personal
                    data include IP address of your device, your broad geographical location (country, state
                    (if applicable), and city) and used product [2].
                  - https://github.com/privacysexy-forks/starter/blob/master/system/siri.sh
                    It includes third-party advertisements [3] and automatic check for updates [4] by default.
                    Both of these behaviors communicate with online services that reveal personal data about you.
                revertCode: defaults write com.apple.assistant.backedup 'Use device speaker for TTS' -int 2
                    [1]: https://web.archive.org/web/20221012155943/https://en.wikipedia.org/wiki/Parallels_Desktop_for_Mac "Parallels Desktop for Mac - Wikipedia | en.wikipedia.org"
                    [2]: https://web.archive.org/web/20221012155829/https://www.parallels.com/about/legal/privacy/ "Privacy Statement | parallels.com"
                    [3]: https://web.archive.org/web/20221012151800/https://kb.parallels.com/114422 "How do I turn off notifications in Parallels Desktop and Parallels Access? | Knowledge Base | parallels.com"
                    [4]: https://web.archive.org/web/20221012151953/http://download.parallels.com/stm/docs/en/Parallels_Desktop_Users_Guide/22220.htm "Automatic Updating | Parallels Desktop Users Guide | download.parallels.com"
                children:://archive.ph/2024.03.14-055010/https://community.jamf.com/t5/jamf-pro/kill-siri/td-p/171543
                    -ttps://web.archive.org/web/20240314060501/https://apple.stackexchange.com/questions/258816/how-to-completely-disable-siri-on-sierra/370426#370426
                        name: Disable Parallels Desktop advertisements `launchctl print-disabled user/$UID` ‚Ä¢ `launchctl print-disabled gui/$UID`
                        recommend: standard
                        docs: |-ble "user/$UID/com.apple.assistantd"
                            Parallels Desktop in-product notifications to show ads from Parallels or other third
                            party companies [1]./com.apple.assistantd'
                  launchctl disable "user/$UID/com.apple.Siri.agent"
                            The main setting is `ProductPromo.ForcePromoOff` [1] that you can check using:
                  sudo launchctl disable 'system/com.apple.Siri.agent'
                            1. `defaults read 'com.parallels.Parallels Desktop' 'ProductPromo.ForcePromoOff'`then
                            2. `defaults read 'com.parallels.Parallels Desktop' 'WelcomeScreenPromo.PromoOff'`m/documentation/security/disabling_and_enabling_system_integrity_protection'
                  fi
                            By default, on clean installations the value is `0` which is equivalent of `no`.
                  launchctl enable "user/$UID/com.apple.assistantd"
                            There is also `WelcomeScreenPromo.PromoOff` setting that's pre-configured to `1` (`no` as
                            default). It's undocumented but still kept disabled by this script.
                  launchctl enable "user/$UID/com.apple.Siri.agent"
                            [1]: https://web.archive.org/web/20240314062932/https://forum.parallels.com/threads/unable-to-process-the-upgrade-request.345603/ "Unable to process the upgrade request | Parallels Forums | forum.parallels.com"
                            [2]: https://web.archive.org/web/20221012151800/https://kb.parallels.com/114422 "How do I turn off notifications in Parallels Desktop and Parallels Access? | Knowledge Base | parallels.com"
                        code: |-n/csrutil status | awk '/status/ {print $5}' | sed 's/\.$//') = "enabled" ]; then
                            defaults write 'com.parallels.Parallels Desktop' 'ProductPromo.ForcePromoOff' -bool yesumentation/security/disabling_and_enabling_system_integrity_protection'
                            defaults write 'com.parallels.Parallels Desktop' 'WelcomeScreenPromo.PromoOff' -bool yes
                        revertCode: |-want to enable Siri?" pop-up
                            defaults write 'com.parallels.Parallels Desktop' 'ProductPromo.ForcePromoOff' -bool no
                            defaults write 'com.parallels.Parallels Desktop' 'WelcomeScreenPromo.PromoOff' -bool yesS [2].
                    -
                        category: Disable Parallels Desktop automatic updateso you want to enable Siri?" [1]
                        docs: |-ad to Siri being enabled unintentionally.
                            Parallels Desktop by default checks for updates frequently and automatically downloads them [1].
                            This reveal personal data about you [2] without your control.etting to suppress this pop-up [1] [2] [3] [4].
                  This command tells the system that the Siri setup is complete, preventing the pop-up in future sessions and
                            [1]: https://web.archive.org/web/20221012151953/http://download.parallels.com/stm/docs/en/Parallels_Desktop_Users_Guide/22220.htm "Automatic Updating | Parallels Desktop Users Guide | download.parallels.com"
                            [2]: https://web.archive.org/web/20221012155829/https://www.parallels.com/about/legal/privacy/ "Privacy Statement | parallels.com"
                        children:chive.ph/2024.03.14-053325/https://discussions.apple.com/thread/7694127?answerId=30752577022&sortBy=best%2330752577022 "macOS keeps nagging me about enabling Siri - Apple Community | discussions.apple.com"
                            -//web.archive.org/web/20240314052600/https://derflounder.wordpress.com/2016/09/20/supressing-siri-pop-up-windows-on-macos-sierra/ "Suppressing Siri pop-up windows on macOS Sierra | Der Flounder"
                                name: Disable automatic downloads for Parallels Desktop updates/siri-keeps-popping-up/ "Siri keeps popping up on Mac? Here's how to easily fix that ‚Ä¢ MacTips | windowsreport.com"
                                docs: |-ve.org/web/20240314052247/https://community.jamf.com/t5/jamf-pro/disable-siri-setup-assistant-in-macos-sierra/m-p/205836/highlight/true#M194536 "Solved: Re: Disable Siri setup assistant in macOS Sierra - Jamf Nation Community - 205834 | community.jamf.com"
                                    Automatic downloads are enabled by default, and this script disables automatic downloads.
                revertCode: defaults delete com.apple.SetupAssistant 'DidSeeSiriSetup'
                                    Automatic downloads are configured using the `Application preferences.Download updates automatically` property [1].
            children:
                                    - Check: `defaults read 'com.parallels.Parallels Desktop' 'Application preferences.Download updates automatically'`
                                    - Values: 0 - Disabled, 1 - Enabled (default)
                code: defaults write com.apple.systemuiserver 'NSStatusItem Visible Siri' 0
                                    [1]: https://web.archive.org/web/20221012153810/https://download.parallels.com/desktop/v18/docs/en_US/Parallels-Desktop-Business-Edition-Administrators-Guide/37744.htm "Parallels Desktop Business Edition Administrator's Guide v18 - Configuring individual Macs | download.parallels.com"
                                code: defaults write 'com.parallels.Parallels Desktop' 'Application preferences.Download updates automatically' -bool no
                                revertCode: defaults write 'com.parallels.Parallels Desktop' 'Application preferences.Download updates automatically' -bool yes
                            -/derflounder.wordpress.com/2016/09/20/blocking-siri-on-macos-sierra/
                                name: Disable automatic checks for Parallels Desktop updates
                                docs: |-le.Siri 'StatusMenuVisible' -bool false
                                    Automatic checks are weekly by default, and this script disables the checks completely.
                revertCode: |-
                                    Frequency to check for updates can be configured using `Application preferences.Check for updates` property [1].
                  defaults delete com.apple.Siri 'UserHasDeclinedEnable'
                                    - Check: `defaults read 'com.parallels.Parallels Desktop' 'Application preferences.Check for updates'`
                                    - Values: 0 - Never, 1 - Once a day, 2 - Once a week (default), 3 - Once a month
        revertCode: sudo mdutil -i on /
                                    [1]: https://web.archive.org/web/20221012153810/https://download.parallels.com/desktop/v18/docs/en_US/Parallels-Desktop-Business-Edition-Administrators-Guide/37744.htm "Parallels Desktop Business Edition Administrator's Guide v18 - Configuring individual Macs | download.parallels.com"
                                code: defaults write 'com.parallels.Parallels Desktop' 'Application preferences.Check for updates' -int 0
                                revertCode: defaults write 'com.parallels.Parallels Desktop' 'Application preferences.Check for updates' -int 2
    -     This script enhances your privacy by deactivating Personalized Ads and disabling the collection
        category: Configure OSed to your device. The process involves modifying certain key configurations,
        children:revents Apple's advertising platform from using your personal information to deliver targeted
            - [1].
                category: Configure Apple Remote Desktop
                children:ed Ads is enabled, your information may be used to provide ads that closely align
                    -nterests [1]. You might occasionally encounter such targeted ads in Apple News, Stocks,
                        name: Disable remote management service will prevent Apple from using your data for
                        recommend: strict does not necessarily decrease the quantity of ads you receive,
                        code: sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop
                        revertCode: sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -activate -restart -agent -console
                    - keys to deactivating personalized ads are:
                        name: Remove Apple Remote Desktop Settings
                        recommend: strictrtising`**: If set to false, this restricts Apple's personalized
                        code: |-is applicable on macOS 12 and subsequent versions [3].
                            sudo rm -rf /var/db/RemoteManagementgIdentifier` is a unique string assigned
                            sudo defaults delete /Library/Preferences/com.apple.RemoteDesktop.plist
                            defaults delete ~/Library/Preferences/com.apple.RemoteDesktop.plistting the
                            sudo rm -rf /Library/Application\ Support/Apple/Remote\ Desktop/here is no
                            rm -r ~/Library/Application\ Support/Remote\ Desktop/ existence [6].
                            rm -r ~/Library/Containers/com.apple.RemoteDesktop
            -tests show that disabling any of the keys mentioned above results in the
                name: Disable online spell correctionersonalized ads" option being deactivated in the GUI,
                code: defaults write NSGlobalDomain WebAutomaticSpellingCorrectionEnabled -bool false
                revertCode: defaults delete NSGlobalDomain WebAutomaticSpellingCorrectionEnabled
            -ase note: The `forceLimitAdTracking` key limits ad tracking [3] [4] and is found in CIS
                name: Disable remote Apple eventsofficial macOS documentation specifies that it is
                recommend: strict7 and newer versions, not to macOS [3]. The key does not exist on the OS
                code: sudo systemsetup -setremoteappleevents off
                revertCode: sudo systemsetup -setremoteappleevents on
            -: https://web.archive.org/web/20230731152633/https://www.apple.com/legal/privacy/data/en/apple-advertising/ "Legal - Apple Advertising & Privacy - Apple"
                name: Disable automatic storage of documents in iCloud Driveple.com/en-sg/guide/mac-help/mh32356/mac "Change Privacy preferences on Mac - Apple Support (SG)"
                docs: https://macos-defaults.com/finder/nsdocumentsavenewdocumentstocloud.htmlation/devicemanagement/restrictions "Restrictions | Apple Developer Documentation"
                recommend: standardorg/web/20230731155653/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_11_0_Big_Sur_Benchmark_v2_0_0.pdf "CIS Apple macOS 11.0 Big Sur Benchmark"
                code: defaults write NSGlobalDomain NSDocumentSaveNewDocumentsToCloud -bool falseon/adsupport/asidentifiermanager/1614151-advertisingidentifier "advertisingIdentifier | Apple Developer Documentation"
                revertCode: defaults delete NSGlobalDomain NSDocumentSaveNewDocumentsToCloud-pro/macos-quot-limit-ad-tracking-quot/td-p/217001 'Solved: macOS "Limit Ad Tracking" - Jamf Nation Community - 217001'
            - |-
                name: Disable display of recent applications on Dockng -bool false
                docs: https://developer.apple.com/documentation/devicemanagement/docke
                code: defaults write com.apple.dock show-recents -bool false
                revertCode: defaults delete com.apple.dock show-recents
            - `defaults read com.apple.AdLib allowApplePersonalizedAdvertising`: true (1)
                name: Disable AirDrop file sharingIdentifierForAdvertising`: true (1)
                recommend: strictapple.AdLib forceLimitAdTracking`: non-existing
                code: defaults write com.apple.NetworkBrowser DisableAirDrop -bool true
                revertCode: defaults write com.apple.NetworkBrowser DisableAirDrop -bool false
            -aults write com.apple.AdLib allowApplePersonalizedAdvertising -bool true
                category: Configure Siri.AdLib forceLimitAdTracking
                children:e and time in screenshot filenames
                    -rict # Minimal privacy benefit, may be inconvenient
                        name: Disable participation in Siri data collection
                        recommend: standardte and time in screenshot filenames on macOS.
                        code: defaults write com.apple.assistant.support 'Siri Data Sharing Opt-In Status' -int 2
                        revertCode: defaults delete com.apple.assistant.support 'Siri Data Sharing Opt-In Status'
                    -
                        category: Disable Siriture whole screen [1]
                        children: + 4** to capture a portion of the screen [1]
                            -nd ‚åò + 4 + space bar** to capture a window or menu [1]
                                name: Disable "Ask Siri"ot app (on macOS Mojave 10.14 or newer) [1]
                                recommend: strict
                                docs: https://derflounder.wordpress.com/2016/09/20/blocking-siri-on-macos-sierra/ons [1].
                                code: defaults write com.apple.assistant.support 'Assistant Enabled' -bool false
                                revertCode: defaults write com.apple.assistant.support 'Assistant Enabled' -bool true
                            -hots save to your desktop with the name `Screenshot [date] at [time].png`.
                                name: Disable Siri voice feedbackh language and 24-hour time settings) confirms screenshots
                                recommend: strict01 at 14.54.39.png`.
                                docs: variations:
                                    - https://github.com/privacysexy-forks/starter/blob/master/system/siri.sh
                                    - https://web.archive.org/web/20201002133713/https://machippie.github.io/system/
                                code: defaults write com.apple.assistant.backedup 'Use device speaker for TTS' -int 3
                                revertCode: defaults write com.apple.assistant.backedup 'Use device speaker for TTS' -int 2
                            - in system language (e.g., `Captura de pantalla` in Spanish) [4]
                                name: Disable Siri services (Siri and assistantd)
                                recommend: stricteenshots by when they were taken.
                                docs:es with timestamps raise several privacy concerns:
                                    - https://web.archive.org/web/20240314060540/https://apple.stackexchange.com/questions/57514/what-is-assistantd
                                    - https://archive.ph/2024.03.14-055010/https://community.jamf.com/t5/jamf-pro/kill-siri/td-p/171543
                                    - https://web.archive.org/web/20240314060501/https://apple.stackexchange.com/questions/258816/how-to-completely-disable-siri-on-sierra/370426#370426
                                # To see status: ‚Ä¢ `launchctl print-disabled system` ‚Ä¢ `launchctl print-disabled user/$UID` ‚Ä¢ `launchctl print-disabled gui/$UID`
                                code: |- vulnerable to targeted phishing attempts, social engineering, or user profiling.
                                    launchctl disable "user/$UID/com.apple.assistantd"ing attempts or customize malware delivery
                                    launchctl disable "gui/$UID/com.apple.assistantd"
                                    sudo launchctl disable 'system/com.apple.assistantd'
                                    launchctl disable "user/$UID/com.apple.Siri.agent"nal settings [2].
                                    launchctl disable "gui/$UID/com.apple.Siri.agent"a point that could be used for user profiling or
                                    sudo launchctl disable 'system/com.apple.Siri.agent'
                                    if [ $(/usr/bin/csrutil status | awk '/status/ {print $5}' | sed 's/\.$//') = "enabled" ]; then
                                        >&2 echo 'This script requires SIP to be disabled. Read more: https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection'
                                    fiyour computer, revealing your daily schedule and work hours.
                                revertCode: |-ations, these timestamps provide evidence of when specific content was viewed or actions were taken.
                                    launchctl enable "user/$UID/com.apple.assistantd"essed websites, viewed documents, or used applications.
                                    launchctl enable "gui/$UID/com.apple.assistantd"ining personal, financial, or work-related information, as
                                    sudo launchctl enable 'system/com.apple.assistantd'erve as digital evidence.
                                    launchctl enable "user/$UID/com.apple.Siri.agent"
                                    launchctl enable "gui/$UID/com.apple.Siri.agent"he timestamp in the filename remains, revealing when the screenshot was taken.
                                    sudo launchctl enable 'system/com.apple.Siri.agent'e), social media platforms (like Twitter, Facebook),
                                    if [ $(/usr/bin/csrutil status | awk '/status/ {print $5}' | sed 's/\.$//') = "enabled" ]; thentill
                                        >&2 echo 'This script requires SIP to be disabled. Read more: https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection'
                                    fi privacy risks persist when sharing files across any platform.
                            -
                                name: Disable "Do you want to enable Siri?" pop-upithout date and time.
                                docs: |-hots, they are numbered sequentially (1, 2, 3...) [3] [5].
                                    This script stops the "Enable Siri" pop-up [1] from appearing the first time a user logs into macOS [2].
                                    Sequoia 15.3):
                                    Introduced in macOS version 10.12 [2], this pop-up asks, "Do you want to enable Siri?" [1]
                                    which could lead to Siri being enabled unintentionally.

                                    This script configures the `com.apple.SetupAssistant!DidSeeSiriSetup` setting to suppress this pop-up [1] [2] [3] [4].
                                    This command tells the system that the Siri setup is complete, preventing the pop-up in future sessions and
                                    enhancing privacy by avoiding unintended Siri activation.
          File naming behavior:
                                    [1]: https://archive.ph/2024.03.14-053325/https://discussions.apple.com/thread/7694127?answerId=30752577022&sortBy=best%2330752577022 "macOS keeps nagging me about enabling Siri - Apple Community | discussions.apple.com"
                                    [2]: https://web.archive.org/web/20240314052600/https://derflounder.wordpress.com/2016/09/20/supressing-siri-pop-up-windows-on-macos-sierra/ "Suppressing Siri pop-up windows on macOS Sierra | Der Flounder"
                                    [3]: https://web.archive.org/web/20240314052901/https://windowsreport.com/mac/siri-keeps-popping-up/ "Siri keeps popping up on Mac? Here's how to easily fix that ‚Ä¢ MacTips | windowsreport.com"
                                    [4]: https://web.archive.org/web/20240314052247/https://community.jamf.com/t5/jamf-pro/disable-siri-setup-assistant-in-macos-sierra/m-p/205836/highlight/true#M194536 "Solved: Re: Disable Siri setup assistant in macOS Sierra - Jamf Nation Community - 205834 | community.jamf.com"
                                code: defaults write com.apple.SetupAssistant 'DidSeeSiriSetup' -bool True
                                revertCode: defaults delete com.apple.SetupAssistant 'DidSeeSiriSetup'
                    - since macOS Sequoia 15.3).
                        category: Remove Siri from user interface
                        children:ur privacy better, but you should know these limitations:
                            -
                                name: Remove Siri from menu bar, which still reveals the date and time the screenshot was taken.
                                recommend: strict
                                code: defaults write com.apple.systemuiserver 'NSStatusItem Visible Siri' 0.
                                revertCode: defaults write com.apple.systemuiserver 'NSStatusItem Visible Siri' 1
                            -
                                name: Remove Siri from status menu
                                recommend: strictose the ability to easily sort screenshots by capture time.
                                docs: https://derflounder.wordpress.com/2016/09/20/blocking-siri-on-macos-sierra/ sort them by capture time.
                                code: |-
                                    defaults write com.apple.Siri 'StatusMenuVisible' -bool false
                                    defaults write com.apple.Siri 'UserHasDeclinedEnable' -bool true
                                revertCode: |-`com.apple.screencapture!include-date` to `false` (`0`) [2] [3] [4] [5] [6].
                                    defaults delete com.apple.Siri 'StatusMenuVisible'
                                    defaults delete com.apple.Siri 'UserHasDeclinedEnable'
            - script restarts `SystemUIServer` (a system process) to apply changes [2] [3] [4] [6].
                name: Disable Spotlight indexing
                code: sudo mdutil -i off -d /
                revertCode: sudo mdutil -i on /the menu bar and GUI [7] [8]
            -uns continuously as a background process [7] [8]
                name: Disable personalized advertisements and identifier tracking],
                recommend: standard Status Icons [7], and Accessibility [7]
                docs: |-the logged-in user (not root) [8]
                    This script enhances your privacy by deactivating Personalized Ads and disabling the collection
                    of identifiers related to your device. The process involves modifying certain key configurations,
                    which prevents Apple's advertising platform from using your personal information to deliver targeted
                    ads [1].ws this step isn't required on macOS Sequoia 15.3.
          Restarting `SystemUIServer` is a safe, routine operation that will not disrupt your work.
                    When Personalized Ads is enabled, your information may be used to provide ads that closely align
                    with your interests [1]. You might occasionally encounter such targeted ads in Apple News, Stocks,
                    and the Mac App Store [2]. Disabling Personalized Ads will prevent Apple from using your data for
                    ad targeting [2]. Although this does not necessarily decrease the quantity of ads you receive,t on Mac - Apple Support | support.apple.com"
                    it may result in the ads being less relevant to your interests [2].ont.net/posts/nihptzqdnu-how-to-remove-timestamp-on-screenshots-in-macos "How to remove timestamp on screenshots in MacOS - Today I Learned | dys2hbvla0n8j.cloudfront.net"
          [3]: https://web.archive.org/web/20250201125037/https://www.idownloadblog.com/2015/04/15/how-to-remove-date-time-screenshots-mac/ "How to remove date and time from screenshot file names on Mac | www.idownloadblog.com"
                    The primary keys to deactivating personalized ads are:om/tutoriales/1039-terminal-2016/92-toma-el-control-de-tus-capturas-de-pantalla-con-la-terminal/ "Toma el control de tus capturas de pantalla con la Terminal | platzi.com"
          [5]: https://web.archive.org/web/20250201125002/https://macos-defaults.com/screenshots/include-date.html "Include date | Screenshots | macOS defaults | macos-defaults.com"
                    - **`allowApplePersonalizedAdvertising`**: If set to false, this restricts Apple's personalizedon_and_file_format/ "3 ways to change the destination of Mac screenshots | Mac Cheat Sheet | yama-mac.com"
                    advertising [3]. This is applicable on macOS 12 and subsequent versions [3].er.html "SystemUIServer: What It Is & Why It Takes High CPU | iboysoft.com"
                    - **`allowIdentifierForAdvertising`**: The `advertisingIdentifier` is a unique string assigneder - Mac Guides | web.archive.org"
                    to each device [5]. Apple uses this identifier and recommends its use in third-party
                    applications for tasks like frequency capping, attribution, conversion events, estimating the
                    number of unique users, detecting advertising fraud, and debugging [5]. Although there is no
                    official documentation on it, a discussion on JAMF.com corroborates its existence [6].
              revertCode: |-
                    My tests show that disabling any of the keys mentioned above results in the
                    "System Preferences > Apple Advertising > Personalized ads" option being deactivated in the GUI,
                    starting from macOS Monterey.
              # Service needs restart to apply changes in both enable/disable cases
                    Please note: The `forceLimitAdTracking` key limits ad tracking [3] [4] and is found in CIS
                    benchmarks for macOS [4]. However, the official macOS documentation specifies that it is
                    applicable only to iOS 7 and newer versions, not to macOS [3]. The key does not exist on the OS
                    by default.ents
    children:
                    [1]: https://web.archive.org/web/20230731152633/https://www.apple.com/legal/privacy/data/en/apple-advertising/ "Legal - Apple Advertising & Privacy - Apple"
                    [2]: https://web.archive.org/web/20220805052411/https://support.apple.com/en-sg/guide/mac-help/mh32356/mac "Change Privacy preferences on Mac - Apple Support (SG)"
                    [3]: https://web.archive.org/web/20230731155827/https://developer.apple.com/documentation/devicemanagement/restrictions "Restrictions | Apple Developer Documentation"
                    [4]: https://web.archive.org/web/20230731155653/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_11_0_Big_Sur_Benchmark_v2_0_0.pdf "CIS Apple macOS 11.0 Big Sur Benchmark"
                    [5]: https://web.archive.org/web/20230731155131/https://developer.apple.com/documentation/adsupport/asidentifiermanager/1614151-advertisingidentifier "advertisingIdentifier | Apple Developer Documentation"
                    [6]: https://web.archive.org/web/20230731154840/https://community.jamf.com/t5/jamf-pro/macos-quot-limit-ad-tracking-quot/td-p/217001 'Solved: macOS "Limit Ad Tracking" - Jamf Nation Community - 217001'
                code: |-daiderd.com/nix-darwin/manual/index.html
                    defaults write com.apple.AdLib allowIdentifierForAdvertising -bool false
                    defaults write com.apple.AdLib allowApplePersonalizedAdvertising -bool false
                    defaults write com.apple.AdLib forceLimitAdTracking -bool true
                # Default: (`defaults read com.apple.AdLib`)pple.alf globalstate -bool true
                #   - `defaults read com.apple.AdLib allowApplePersonalizedAdvertising`: true (1)
                #   - `defaults read com.apple.AdLib allowIdentifierForAdvertising`: true (1)
                #   - `defaults read com.apple.AdLib forceLimitAdTracking`: non-existing
                revertCode: |-ite /Library/Preferences/com.apple.alf globalstate -bool false
                    defaults write com.apple.AdLib allowIdentifierForAdvertising -bool true
                    defaults write com.apple.AdLib allowApplePersonalizedAdvertising -bool true
                    sudo defaults delete com.apple.AdLib forceLimitAdTracking
            -ocs:
                name: Disable date and time in screenshot filenames18-10-01/finding/V-81671
                recommend: strict # Minimal privacy benefit, may be inconvenient
                docs: |-
                    This script disables including date and time in screenshot filenames on macOS.
              sudo defaults write /Library/Preferences/com.apple.alf loggingenabled -bool true
                    On macOS, you can take screenshots using:
              /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode off
                    - **Shift ‚áß + Command ‚åò + 3** to capture whole screen [1]nabled -bool false
                    - **Shift ‚áß + Command ‚åò + 4** to capture a portion of the screen [1]
                    - **Shift ‚áß + Command ‚åò + 4 + space bar** to capture a window or menu [1]
                    - **Shift ‚áß + Command ‚åò + 5** to open Screenshot app (on macOS Mojave 10.14 or newer) [1]
              - https://www.stigviewer.com/stig/apple_os_x_10.8_mountain_lion_workstation/2015-02-10/finding/V-51327
                    On macOS Mojave 10.14 or newer, you can use the **Screenshot** app to set a timer or choose save locations [1].
                    However, this app does not allow filename configurations, which this script configures automatically.
            code: |-
                    By default, screenshots save to your desktop with the name `Screenshot [date] at [time].png`.
                    For example, testing on macOS Sequoia 15.3 (with English language and 24-hour time settings) confirms screenshots
                    are named exactly: `Screenshot 2025-02-01 at 14.54.39.png`.l true
                    However, there can be other variations:
              /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode off
                    - Other system configurations may show AM/PM in time [2].nabled -bool false
                    - The word `Screenshot` may vary:all EnableStealthMode -bool false
                        - It can appear as `Screen Shot` [1] [3]traffic in applications
                        - It can appear in system language (e.g., `Captura de pantalla` in Spanish) [4]
              - name: Disable automatic incoming connections for signed apps
                    The timestamp feature lets you sort screenshots by when they were taken.
                    However, screenshot filenames with timestamps raise several privacy concerns:
                code: sudo defaults write /Library/Preferences/com.apple.alf allowsignedenabled -bool false
                    - **System Language & Region:**brary/Preferences/com.apple.alf allowsignedenabled -bool true
                        Your system language and regional characters in filenames can reveal your location and language preferences [4].
                        This reveals your likely location and preferred language.
                        This information makes you vulnerable to targeted phishing attempts, social engineering, or user profiling.
                        Attackers could use this cultural context to craft more convincing phishing attempts or customize malware delivery
                        methods based on your region.ary/Preferences/com.apple.alf allowdownloadsignedenabled -bool true
                    - **Time Format:**etection
                        The format of timestamps (12 or 24-hour) reveals your timezone and regional settings [2].
                        This exposes your timezone and regional settings, providing another data point that could be used for user profiling or
                        targeted attacks.cy and security by disabling automatic detection of captive
                    - **Usage Patterns:**network connections.
                        Timestamps create a detailed log of when you use your computer, revealing your daily routines and active hours.
                        This shows when you use your computer, revealing your daily schedule and work hours.
                        In forensic analysis or investigations, these timestamps provide evidence of when specific content was viewed or actions were taken.
                        For example, a series of screenshots with timestamps shows when you accessed websites, viewed documents, or used applications.
                        This chronological trail is especially sensitive for screenshots containing personal, financial, or work-related information, as
                        it creates a record of your activities that could compromise privacy or serve as digital evidence.
                    - **Persistent Timestamps:**ic webpages where they must log in [2] [3] [4] [5] [6].
                        Even when sharing screenshots through services that remove metadata, the timestamp in the filename remains, revealing when the screenshot was taken.
                        When sharing screenshots through cloud storage (like Dropbox, Google Drive), social media platforms (like Twitter, Facebook),
                        or messaging apps (like WhatsApp, Telegram) that may strip EXIF metadata for privacy, the timestamp in the filename still
                        reveals when the screenshot was taken since filename remains unchanged during upload.
                        This makes all the above privacy risks persist when sharing files across any platform.

                    After running this script, screenshots will only include a simple name without date and time.
                    When you take multiple screenshots, they are numbered sequentially (1, 2, 3...) [3] [5].
          1. The system checks for captive portals by sending requests to specific URLs [5] [6]:
                    Examples (tested on macOS Sequoia 15.3):` (for OS X 10.10 Yosemite and newer [4]).
             - `http://www.apple.com/library/test/success.html` (for OS X up to 10.9 Mavericks) [4] [6].
                    - `Screenshot.png`ected, then Apple knows there is a portal [5].
                    - `Screenshot 1.png`er to allow login [4] [5] [6].
                    - `Screenshot 2.png`called the 'Captive Network Assistant' [4] [7],
                    - ...`/System/Library/CoreServices/Captive Network Assistant.app` [7].
             This browser is based on Safari [4].
                    File naming behavior:ues with some networks [4].

                    - The system automatically adds numbers to filenames to prevent duplicates [3] [5].
                        For example, as you take multiple screenshots in sequence, they are automatically numbered as
                        `Screenshot 1.png`, `Screenshot 2.png`, `Screenshot 3.png`, and so on to ensure each file has a unique name.
                    - When a numbered file is deleted (e.g., `Screenshot 1.png`), the next screenshot uses
                        the first available number rather than continuing the sequence
                        (tested since macOS Sequoia 15.3).rsonal details such as email and phone numbers [2] [3] [5],
            which may be used for marketing or sales [3].
                    This change protects your privacy better, but you should know these limitations:se to your identity [3].
          - **Data Leakage:**
                    - This script has no effect on the file creation date, which still reveals the date and time the screenshot was taken.
                        It only affects the filenames.
                    - These settings only work with macOS's built-in screenshot tool, not third-party screenshot apps.arily true [3].
                    - You will need to rename files manually to keep them organized without timestamps.
            Captive portals can alter HTTPS connections, causing frequent security warnings [3].
                    > **Caution:**can lower your security awareness [3].
                    > After running this script, you will lose the ability to easily sort screenshots by capture time.
                    > Consider creating folders or adding descriptive names to organize screenshots since you can no longer sort them by capture time.
          - **False Captive Portals (Evil Twins):**
                    ### Technical Detailsd to look like legitimate ones, can steal sensitive information such as credit card
            data and user credentials [6].
                    This script sets the system setting `com.apple.screencapture!include-date` to `false` (`0`) [2] [3] [4] [5] [6].
                    By default, this setting is not configured [5] [6].and cross-site scripting to deploy malicious code [6],
            directing users to harmful sites or stealing data.
                    The script restarts `SystemUIServer` (a system process) to apply changes [2] [3] [4] [6].
                    This process:hinder or manipulate devices' built-in mechanisms for detecting and managing them [3].
            This manipulation can broaden your device's exposure to attacks, potentially compromising its security.
                    - Manages user interface elements in the menu bar and GUI [7] [8]
                    - Runs continuously as a background process [7] [8]tal logins without user consent [4] [6] [7],
                    - Controls the Apple Menu Bar [8], Notifications [7], Control Center [7],
                        Spotlight Search [7], Status Icons [7], and Accessibility [7]
                    - Is owned by the logged-in user (not root) [8]
                    - Automatically restarts if crashed or force quit [8]
          Disabling captive portal detection stops automatic login page prompts.
                    The script restarts `SystemUIServer` to ensure compatibility across all macOS versions,
                    though testing shows this step isn't required on macOS Sequoia 15.3. interactions
                    Restarting `SystemUIServer` is a safe, routine operation that will not disrupt your work.
                    It will not close any applications, lose any unsaved work, or affect your open windows.
                    It simply refreshes the menu bar interface to apply the new screenshot settings.
          `/Library/Preferences/SystemConfiguration/com.apple.captive.control.plist!Active` [8].
                    [1]: https://web.archive.org/web/20250201125948/https://support.apple.com/en-us/102646 "Take a screenshot on Mac - Apple Support | support.apple.com"
                    [2]: https://web.archive.org/web/20250201131350/https://dys2hbvla0n8j.cloudfront.net/posts/nihptzqdnu-how-to-remove-timestamp-on-screenshots-in-macos "How to remove timestamp on screenshots in MacOS - Today I Learned | dys2hbvla0n8j.cloudfront.net"
                    [3]: https://web.archive.org/web/20250201125037/https://www.idownloadblog.com/2015/04/15/how-to-remove-date-time-screenshots-mac/ "How to remove date and time from screenshot file names on Mac | www.idownloadblog.com"
                    [4]: https://web.archive.org/web/20250201132721/https://platzi.com/tutoriales/1039-terminal-2016/92-toma-el-control-de-tus-capturas-de-pantalla-con-la-terminal/ "Toma el control de tus capturas de pantalla con la Terminal | platzi.com"
                    [5]: https://web.archive.org/web/20250201125002/https://macos-defaults.com/screenshots/include-date.html "Include date | Screenshots | macOS defaults | macos-defaults.com"
                    [6]: https://web.archive.org/web/20250201125012/https://yama-mac.com/en/change_the_screenshot_save_location_and_file_format/ "3 ways to change the destination of Mac screenshots | Mac Cheat Sheet | yama-mac.com"
                    [7]: https://web.archive.org/web/20250201132826/https://iboysoft.com/wiki/systemuiserver.html "SystemUIServer: What It Is & Why It Takes High CPU | iboysoft.com"
                    [8]: https://web.archive.org/web/20160313164204/http://guides.macrumors.com/SystemUIServer "SystemUIServer - Mac Guides | web.archive.org"
                call::**
                    -abling this feature, you must manually access network login pages at places like airports and cafes.
                        function: RunInlineCodeps.
                        parameters:
                            code: defaults write 'com.apple.screencapture' 'include-date' -bool falsertBy=best "Force captive portal sign in page to open - Apple Community | discussions.apple.com"
                            revertCode: |-/20240604205332/https://support.apple.com/en-us/102554 "Use captive Wi-Fi networks on your iPhone or iPad - Apple Supportsupport.apple.com "
                                defaults delete 'com.apple.screencapture' 'include-date'2017/08/how-captive-portals-interfere-wireless-security-and-privacy "How Captive Portals Interfere With Wireless Security and Privacy | Electronic Frontier Foundation | eff.org"
                    -//web.archive.org/web/20170622064304/https://grpugh.wordpress.com/2014/10/29/an-undocumented-change-to-captive-network-assistant-settings-in-os-x-10-10-yosemite/ "An undocumented change to Captive Network Assistant settings in OS X 10.10 Yosemite | On the Subject Of Macs | grpugh.wordpress.com"
                        function: RunInlineCode0609154113/https://blog.erratasec.com/2010/09/apples-secret-wispr-request.html#.WdnPa5OyL6Y "Errata Security: Apple's secret \"wispr\" request | blog.erratasec.com"
                        parameters:org/web/20130407200745/http://www.divertednetworks.net/apple-captiveportal.html "Disabling Mac OS Captive Portal Redirection | www.divertednetworks.net"
                            # Service needs restart to apply changes in both enable/disable casesns/45418/how-to-automatically-login-to-captive-portals-on-os-x/74473#74473 "wifi - How to automatically login to captive portals on OS X? - Ask Different | apple.stackexchange.com"
                            # sudo required to kill a process that's not owned by the userm/2012/09/disable-captive-network-support-in-os-x.html "Technical notes, my online memory: Disable Captive Network Support in OS X | ilostmynotes.blogspot.com"
                            code: killall SystemUIServerSystemConfiguration/com.apple.captive.control.plist' Active -bool false
                            revertCode: killall SystemUIServer3)
    -     sudo defaults delete '/Library/Preferences/SystemConfiguration/com.apple.captive.control.plist' Active
        category: Security improvementseen saver
        children:
            -ame: Enable password requirement for waking from sleep or screen saver
                category: Configure macOS Application Firewallents unauthorized users from accessing the current user's account.
                children:/www.stigviewer.com/stig/apple_macos_11_big_sur/2020-11-27/finding/V-230744
                    -o defaults write /Library/Preferences/com.apple.screensaver askForPassword -bool true
                        name: Enable application firewallferences/com.apple.screensaver askForPassword
                        recommend: standardseconds after screen saver initiation
                        docs:.stigviewer.com/stig/apple_macos_11_big_sur/2020-11-27/finding/V-230745
                            - https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81681
                            - https://daiderd.com/nix-darwin/manual/index.htmler 'askForPasswordDelay' -int 5
                            - https://developer.apple.com/documentation/devicemanagement/firewallsswordDelay'
                        code: |-accounts
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on
                            sudo defaults write /Library/Preferences/com.apple.alf globalstate -bool true
                            defaults write com.apple.security.firewall EnableFirewall -bool true
                        revertCode: |- your Mac without a password or account [1].
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate offcess [2] [3] [4].
                            sudo defaults write /Library/Preferences/com.apple.alf globalstate -bool false
                            defaults write com.apple.security.firewall EnableFirewall -bool false
                    -
                        name: Enable firewall logging
                        recommend: standard1]
                        docs:rypted disks when **FileVault** is enabled [1] [2]
                            - https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81671
                            - https://daiderd.com/nix-darwin/manual/index.html
                        code: |-
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode on
                            sudo defaults write /Library/Preferences/com.apple.alf loggingenabled -bool true
                        revertCode: |- on shared devices [1] [2]
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setloggingmode off
                            sudo defaults write /Library/Preferences/com.apple.alf loggingenabled -bool false
                    -
                        name: Enable stealth modeese risks:
                        recommend: standard
                        docs:ss to shared resources [3]
                            - https://www.stigviewer.com/stig/apple_os_x_10.8_mountain_lion_workstation/2015-02-10/finding/V-51327
                            - https://daiderd.com/nix-darwin/manual/index.html
                            - https://developer.apple.com/documentation/devicemanagement/firewall
                        code: |-
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode onures system resources from misuse [4].
                            sudo defaults write /Library/Preferences/com.apple.alf stealthenabled -bool trueting guest access [3] [4].
                            defaults write com.apple.security.firewall EnableStealthMode -bool true
                        revertCode: |-res may also improve system performance by:
                            /usr/libexec/ApplicationFirewall/socketfilterfw --setstealthmode off
                            sudo defaults write /Library/Preferences/com.apple.alf stealthenabled -bool false
                            defaults write com.apple.security.firewall EnableStealthMode -bool false
                    -g unnecessary network traffic
                        category: Disable automatic permission for incoming traffic in applications
                        children:nments, a guest account can be beneficial or necessary.
                            -ing temporary access on shared devices can help separate casual users from sensitive data.
                                name: Disable automatic incoming connections for signed apps
                                docs: https://daiderd.com/nix-darwin/manual/index.html
                                recommend: stricteatures may impact legitimate use cases like
                                code: sudo defaults write /Library/Preferences/com.apple.alf allowsignedenabled -bool false
                                revertCode: sudo defaults write /Library/Preferences/com.apple.alf allowsignedenabled -bool true
                            -e.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                                name: Disable automatic incoming connections for downloaded signed appsent/help/script-to-enable-guest-user-on-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
                                docs: https://daiderd.com/nix-darwin/manual/index.htmltig/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                                recommend: strict25065056/https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81615 "The macOS system must not have a guest account. | www.stigviewer.com"
                                code: sudo defaults write /Library/Preferences/com.apple.alf allowdownloadsignedenabled -bool false
                                revertCode: sudo defaults write /Library/Preferences/com.apple.alf allowdownloadsignedenabled -bool true
            -ecommend: strict # Disabled by default, but if user enabled it manually, there may be a need.
                name: Disable captive portal detection
                recommend: stricts the macOS guest account login to enhance system security by blocking unauthorized access.
                docs: |-
                    This script enhances your privacy and security by disabling automatic detection of captive
                    portals, preventing unintended network connections. guest access to sharing services [1] [2].
                    However, this change requires users to manually open a web browser to access such networks [1].

                    ### Overview of captive portals] [2] [3] [4]
              - Cannot modify system or user settings [3] [4]
                    Captive portals are also known as *subscription* or *Wi-Fi Hotspot* networks [2].
                    These are common in public places like coffee shops, hotels, and airports [2] [3] [4].
                    These portals redirect users to specific webpages where they must log in [2] [3] [4] [5] [6].
                    Typically, this page requires users to enter personal details, like email and phone number, restrictions
                    and agree to terms of service [2] [3] [5] [6].] [5].
                    This poses privacy risks because your personal details may be used for marketing or other purposes.vileges [1] [2].

                    ### macOS captive portal flowunt feature on macOS [5].
              It prevents anyone from accessing the system without a password [1] [2] [3] [4] [6].
                    On macOS, when connecting to a WiFi network: of basic reconnaissance and potential privilege escalation [1] [2] [5] [7].

                    1. The system checks for captive portals by sending requests to specific URLs [5] [6]:
                       - `http://captive.apple.com/hotspot-detect.html` (for OS X 10.10 Yosemite and newer [4]).
                       - `http://www.apple.com/library/test/success.html` (for OS X up to 10.9 Mavericks) [4] [6].
                    2. If the request gets redirected, then Apple knows there is a portal [5].s and best practices
                    3. macOS opens a limited browser to allow login [4] [5] [6].
                       The browser used for this, called the 'Captive Network Assistant' [4] [7],
                       is found at `/System/Library/CoreServices/Captive Network Assistant.app` [7].
                       This browser is based on Safari [4]. agency that provides cybersecurity guidance for military systems
                       Its limitation may cause issues with some networks [4].
              Disabling guest login blocks unauthenticated users from accessing the system and strengthens security controls [7].
                    ### Security and privacy concerns with captive portals
              However, there are specific use cases where guest access may be beneficial:
                    Using captive portals raises security and privacy issues:
              - Providing temporary access on shared devices [3]
                    - **Data Collection and Monitoring:**ting access to private data [3]
                      Captive portals often require you to submit personal details such as email and phone numbers [2] [3] [5],
                      which may be used for marketing or sales [3].
                      Additionally, they facilitate the tracking of your behaviors and activities, linking these to your identity [3].
                    - **Data Leakage:**g a guest account may be useful for temporary access, public kiosks, or assisting with
                      Devices send data about network connections to Apple without user consent [5] [6], compromising privacy.
                    - **False Sense of Security:**r keeping guest login enabled.
                      The login window may falsely imply that networks with captive portals are more secure, which is not necessarily true [3].
                    - **Misplaced Trust:**arios (like libraries, schools, or reception computers), you may want to carefully
                      Captive portals can alter HTTPS connections, causing frequent security warnings [3].
                      Ignoring these alerts can lower your security awareness [3].itting safe usage by multiple people.
                    - **WISPr: Credential Theft and XML Attacks:**
                      Captive portals that use WISPr technology might expose users to risks of credential theft and attacks based on XML [5].
                    - **False Captive Portals (Evil Twins):**rs from accessing your Mac without a user account.
                      Fake captive portals, designed to look like legitimate ones, can steal sensitive information such as credit card
                      data and user credentials [6].
                    - **Fraud/Fake Website due to MiTM Attacks:**
                      Attackers may exploit captive portals using HTML injection and cross-site scripting to deploy malicious code [6],
                      directing users to harmful sites or stealing data.
                    - **Captive Portal Detection Interference:**
                      Some captive portals hinder or manipulate devices' built-in mechanisms for detecting and managing them [3].
                      This manipulation can broaden your device's exposure to attacks, potentially compromising its security.
                    - **Unintended Application Launch:**er system user accounts [9].
                      Devices may automatically open applications for captive portal logins without user consent [4] [6] [7],
                      risking unauthorized access and exposure to threats like malware.
              This script does not modify `/Library/Preferences/com.apple.loginwindow!Hide500Users` because this setting would
                    ### Solution and impactd other system accounts [10] [11].

                    Disabling captive portal detection stops automatic login page prompts.tem Preferences** may not
                    It requires users to manually navigate to these pages when needed [1].
                    This change reduces the risk of automatic data collection and unwanted network interactions
                    but may inconvenience users frequently connecting to public networks.its/items/CIS_Apple_macOS_11_v1.1.0_L1.audit:153219403c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
              [2]: https://archive.ph/2025.01.12-201010/https://www.scaprepo.com/view.jsp?id=CCE-50057-9 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
                    This script disables the captive portal detection by modifying the system settinganagement/help/script-to-enable-guest-user-on-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
                    `/Library/Preferences/SystemConfiguration/com.apple.captive.control.plist!Active` [8].s8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
              [5]: https://web.archive.org/web/20241125172444/https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                    This script does not:5.01.12-200100/https://gist.github.com/justinpawela/8a924f36f86bac2b563bf6832eefff25?permalink_comment_id=1893323%23gistcomment-1893323 "Comment | Disable macOS Guest user account script | gist.github.com"
              [7]: https://web.archive.org/web/20241125065056/https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81615 "The macOS system must not have a guest account. | www.stigviewer.com"
                    - Alter the system application (`/System/Library/CoreServices/Captive Network Assistant.app`),s/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                      which is protected by "System Integrity Protection (SIP)" [7].ysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                    - Block captive portal hosts by manipulating DNS records [4] [6].com/questions/17543231/hidden-accounts-on-osx#answer-17552759 "macos - Hidden accounts on OSX - Stack Overflow | stackoverflow.com"
                      Instead, it disables automatic checks but allows manual access when needed [1].red-team/blob/master/atomics/T1564.002/T1564.002.md "atomic-red-team/atomics/T1564.002/T1564.002.md at master ¬∑ privacysexy-forks/atomic-red-team ¬∑ GitHub | github.com"
            call:
                    > **Caution:**eCode
                    > After disabling this feature, you must manually access network login pages at places like airports and cafes.
                    > This may involve some technical steps.ences/com.apple.loginwindow' 'GuestEnabled' -bool NO
                  revertCode:
                    [1]: https://archive.ph/2024.06.07-084600/https://discussions.apple.com/thread/250195103?sortBy=best "Force captive portal sign in page to open - Apple Community | discussions.apple.com"
                    [2]: https://web.archive.org/web/20240604205332/https://support.apple.com/en-us/102554 "Use captive Wi-Fi networks on your iPhone or iPad - Apple Supportsupport.apple.com "
                    [3]: https://web.archive.org/web/20240530092050/https://www.eff.org/deeplinks/2017/08/how-captive-portals-interfere-wireless-security-and-privacy "How Captive Portals Interfere With Wireless Security and Privacy | Electronic Frontier Foundation | eff.org"
                    [4]: https://web.archive.org/web/20170622064304/https://grpugh.wordpress.com/2014/10/29/an-undocumented-change-to-captive-network-assistant-settings-in-os-x-10-10-yosemite/ "An undocumented change to Captive Network Assistant settings in OS X 10.10 Yosemite | On the Subject Of Macs | grpugh.wordpress.com"
                    [5]: https://web.archive.org/web/20240609154113/https://blog.erratasec.com/2010/09/apples-secret-wispr-request.html#.WdnPa5OyL6Y "Errata Security: Apple's secret \"wispr\" request | blog.erratasec.com"
                    [6]: https://web.archive.org/web/20130407200745/http://www.divertednetworks.net/apple-captiveportal.html "Disabling Mac OS Captive Portal Redirection | www.divertednetworks.net"
                    [7]: https://web.archive.org/web/20240604205338/https://apple.stackexchange.com/questions/45418/how-to-automatically-login-to-captive-portals-on-os-x/74473#74473 "wifi - How to automatically login to captive portals on OS X? - Ask Different | apple.stackexchange.com"
                    [8]: https://web.archive.org/web/20240604205756/https://ilostmynotes.blogspot.com/2012/09/disable-captive-network-support-in-os-x.html "Technical notes, my online memory: Disable Captive Network Support in OS X | ilostmynotes.blogspot.com"
                code: sudo defaults write '/Library/Preferences/SystemConfiguration/com.apple.captive.control.plist' Active -bool false
                revertCode: >- # Missing by default since macOS (‚â• 14.3)
                    sudo defaults delete '/Library/Preferences/SystemConfiguration/com.apple.captive.control.plist' Active
            -
                category: Enable protective screen savercess shared folders without authentication [1] [2].
                children:
                    -llows users to share entire systems or specific folders with others on a network [3].
                        name: Enable password requirement for waking from sleep or screen saverfile sharing alternatives.
                        # The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.
                        docs: https://www.stigviewer.com/stig/apple_macos_11_big_sur/2020-11-27/finding/V-230744
                        code: sudo defaults write /Library/Preferences/com.apple.screensaver askForPassword -bool true
                        revertCode: sudo defaults delete /Library/Preferences/com.apple.screensaver askForPasswordaccounts [8].
                    -nally, Guest User accounts on macOS:
                        name: Enable session lock five seconds after screen saver initiation
                        docs: https://www.stigviewer.com/stig/apple_macos_11_big_sur/2020-11-27/finding/V-230745
                        # An unattended system with an excessive grace period is vulnerable to a malicious user.
                        code: sudo defaults write /Library/Preferences/com.apple.screensaver 'askForPasswordDelay' -int 5
                        revertCode: sudo defaults delete /Library/Preferences/com.apple.screensaver 'askForPasswordDelay'
            - - Can only use Safari when FileVault encryption is enabled [8]
                category: Disable guest accountsnd My** app if lost [8]
                docs: |-
                    These scripts control guest access on macOS to protect your system's security and privacy.
                    mproves your security and privacy by preventing unauthorized users from:
                    Guest access lets anyone use your Mac without a password or account [1].
                    This convenience creates security and privacy risks by allowing unauthorized system access [2] [3] [4].
              - Performing network reconnaissance [4]
                    Guest users have limited privileges:ities for privilege escalation [4]

                    - Access without authentication [1] [2] security organizations:
                    - Cannot modify system settings [1]
                    - Cannot access encrypted disks when **FileVault** is enabled [1] [2]overnment cybersecurity standards agency [9]
                    - Files are automatically deleted upon logout [1] [2]organization that creates security guidelines used worldwide [4]
                    - Can use basic applications like Safari [1] [2]
              This script may also provide a performance benefit by reducing overhead for guest connections.
                    Guest access serves specific purposes:
              > **Caution:**
                    - Providing temporary access on shared devices [1] [2]ts for anyone who needs to access your shared files [3].
                    - Enabling lost device location through the **Find My** app [1]
                    - Allowing basic internet access without exposing personal data [1]

                    Leaving guest access enabled creates these risks:

                    - Unauthorized access to shared resources [3]
                    - System reconnaissance opportunities [3]m.apple.smb.server!AllowGuestAccess`) [4] [9]
                    - Potential security vulnerabilities [3]nctl` with `-smbGuestAccess off` option [10]
                    - Access to network-shared files and folders [3]er accounts [10].

                    Restricting or disabling guest access reduces the risk of unauthorized logins and secures system resources from misuse [4].c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
                    Security organizations, including the Defense Information Systems Agency (DISA), recommend restricting guest access [3] [4]. Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
              [3]: https://web.archive.org/web/20240728041621/https://support.apple.com/en-gb/guide/mac-help/mh17131/mac "Set up file sharing on Mac | support.apple.com"
                    Disabling guest access features may also improve system performance by:rol.jsp?command=relation&relationId=CCE-50149-4 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | scaprepo.com"
              [5]: https://web.archive.org/web/20241125012504/https://learn.microsoft.com/en-gb/windows/win32/fileio/microsoft-smb-protocol-and-cifs-protocol-overview "Microsoft SMB Protocol and CIFS Protocol Overview | learn.microsoft.com"
                    - Reducing network scanning for guest accesstps://learn.microsoft.com/en-us/windows-server/storage/file-server/file-server-smb-overview "Overview of file sharing using the SMB 3 protocol in Windows Server | learn.microsoft.com"
                    - Decreasing authentication overhead91313/https://www.apple.com/server/docs/File_Services_TB_v10.4.pdf "File Services | High-performance workgroup and Internet file sharingfor Mac, Windows, and Linux clients. | www.apple.com"
                    - Minimizing unnecessary network traffics://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
              [9]: https://web.archive.org/web/20240928201604/https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                    However, in some environments, a guest account can be beneficial or necessary.ml "bg Man Page - macOS - SS64.com | ss64.com"
                    For example, providing temporary access on shared devices can help separate casual users from sensitive data.
                    Enabling guests may also assist with the **Find My** app if your Mac is lost [3].
                parameters:
                    > **Caution:** Disabling guest access features may impact legitimate use cases likever' 'AllowGuestAccess' -bool NO
                    > device recovery through **Find My** app and temporary access for trusted users.
                    |- # Does not exist by default since macOS Sonoma 14.5
                    [1]: https://archive.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                    [2]: https://web.archive.org/web/20241008165805/https://www.hexnode.com/mobile-device-management/help/script-to-enable-guest-user-on-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
                    [3]: https://web.archive.org/web/20241125172444/https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                    [4]: https://web.archive.org/web/20241125065056/https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81615 "The macOS system must not have a guest account. | www.stigviewer.com"
                children:udo sysadminctl -smbGuestAccess off
                    -ertCode: sudo sysadminctl -smbGuestAccess on
                        name: Disable guest account login
                        recommend: strict # Disabled by default, but if user enabled it manually, there may be a need.
                        docs: |-
                            This script disables the macOS guest account login to enhance system security by blocking unauthorized access.

                            A guest account lets anyone use your Mac temporarily without a password or account [1].haring [1].
                            By default, macOS disables guest login but allows limited guest access to sharing services [1] [2].
                            When enabled, guest users:o sharing services [2] [3].
              It allows you to share files and folders with others on your network [4].
                            - Do not need a password to log in [1] [2] [3] [4]rs without requiring permission [5] [6].
                            - Cannot modify system or user settings [3] [4]
                            - Cannot access encrypted disks if FileVault is enabled [3] [4]sing your shared files through AFP sharing.
                            - Have their files and activities automatically deleted upon logout [1] [3] [4] system [5] or
              gain increased system access through guest sharing vulnerabilities [7].
                            Although guest users cannot modify system settings or remotely access the system [1], the limited restrictions
                            on guest access can still pose security risks [1] [2] [5].
                            Attackers can use guest access to collect system information and potentially gain higher-level system privileges [1] [2].
              - Unauthorized users may access shared files [7]
                            This script disables the guest account feature on macOS [5].cessible folders,
                            It prevents anyone from accessing the system without a password [1] [2] [3] [4] [6].
                            By restricting guest access, it reduces the chance of basic reconnaissance and potential privilege escalation [1] [2] [5] [7].

                            The following security organizations recommend disabling guest access [1] [5] [7] [8]:

                            - **Center for Internet Security (CIS)** [1]:
                              A non-profit organization that develops globally recognized security benchmarks and best practices
                            - **National Institute of Standards and Technology (NIST)** [8]:
                              A U.S. government agency that develops cybersecurity standards and guidelines
                            - **Defense Information Systems Agency (DISA)** [5] [7]:
                              A U.S. Department of Defense combat support agency that provides cybersecurity guidance for military systems

                            Disabling guest login blocks unauthenticated users from accessing the system and strengthens security controls [7].
              - The Center for Internet Security (CIS), that provides best practices for securing IT systems [7]
                            However, there are specific use cases where guest access may be beneficial:
              After running this script, configure access via System Settings to share files with specific users.
                            - Providing temporary access on shared devices [3]
                            - Allowing internet access [4] while preventing access to private data [3]rmission to access files shared from your Mac.
                            - Enabling the **Find My** app feature [4], which helps locate lost devices when someone uses
                            Safari as a guest [3] [4]

                            In some situations, having a guest account may be useful for temporary access, public kiosks, or assisting with
                            **Find My**, which relies on guest network usage if your device is lost [3] [4].
                            If you need those functions, consider keeping guest login enabled.
                `/Library/Preferences/com.apple.AppleFileServer!guestAccess` [5] [6] [7] [8] [10].
                            For multi-user or kiosk scenarios (like libraries, schools, or reception computers), you may want to carefully
                            configure a limited account instead of relying on the guest session.
                            This approach helps maintain necessary restrictions while still permitting safe usage by multiple people.

                            > **Caution:**/web/20250113191313/https://www.apple.com/server/docs/File_Services_TB_v10.4.pdf "File Services | High-performance workgroup and Internet file sharingfor Mac, Windows, and Linux clients. | www.apple.com"
                            > Disabling guest access prevents temporary users from accessing your Mac without a user account.L1.audit:153219403c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
                            > This may impact **Find My** app and other temporary-access scenarios.057-9 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
              [4]: https://web.archive.org/web/20240728041621/https://support.apple.com/en-gb/guide/mac-help/mh17131/mac "Set up file sharing on Mac | support.apple.com"
                            ### Technical Details240421151410/https://events.ccc.de/congress/2004/fahrplan/files/95-macosx-insecurity-paper.pdf "Practical Mac OS X Insecurity Security Concepts, Problems, and Exploits on Your Mac | cdn2.qualys.com/docs/release-notes | events.ccc.de"
              [6]: https://web.archive.org/web/20071102090442/http://www.princeton.edu:80/~psg/unix/osx/osxsecurity.html "OS X Security | www.princeton.edu"
                            The script:org/web/20250113201942/https://www.scaprepo.com/control.jsp?command=relation&relationId=CCE-50149-4 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | scaprepo.com"
              [8]: https://web.archive.org/web/20240928201604/https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                            - Modifies `/Library/Preferences/com.apple.loginwindow!GuestEnabled` [1] [2] [3] [6] [8].5.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                            - Executes the `sysadminctl` command with `-guestAccount off`.s/release-notes/qualys-api-rti.pdf "Qualys API Release Notes | cdn2.qualys.com"
                              `sysadminctl` is a tool used to administer system user accounts [9].ml "bg Man Page - macOS - SS64.com | ss64.com"
                              `-guestAccount Off` option disables the guest account [9].
              - function: RunInlineCode
                            This script does not modify `/Library/Preferences/com.apple.loginwindow!Hide500Users` because this setting would
                            affect both guest accounts and other system accounts [10] [11].' 'guestAccess' -bool NO
                  revertCode:
                            **Note:** After running this script, the **Users & Groups** section in **System Preferences** may not
                            correctly display the guest account status on older macOS versions [6].ess'
              - function: RunIfCommandExists
                            [1]: https://web.archive.org/web/20250123200241/https://www.tenable.com/audits/items/CIS_Apple_macOS_11_v1.1.0_L1.audit:153219403c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
                            [2]: https://archive.ph/2025.01.12-201010/https://www.scaprepo.com/view.jsp?id=CCE-50057-9 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
                            [3]: https://web.archive.org/web/20241008165805/https://www.hexnode.com/mobile-device-management/help/script-to-enable-guest-user-on-mac/ "Script to enable Guest User on Mac | www.hexnode.com"
                            [4]: https://archive.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                            [5]: https://web.archive.org/web/20241125172444/https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230823 "The macOS system must enforce access restrictions. | www.stigviewer.com"
                            [6]: https://archive.ph/2025.01.12-200100/https://gist.github.com/justinpawela/8a924f36f86bac2b563bf6832eefff25?permalink_comment_id=1893323%23gistcomment-1893323 "Comment | Disable macOS Guest user account script | gist.github.com"
                            [7]: https://web.archive.org/web/20241125065056/https://www.stigviewer.com/stig/apple_os_x_10.13/2018-10-01/finding/V-81615 "The macOS system must not have a guest account. | www.stigviewer.com"
                            [8]: https://web.archive.org/web/20240928201604/https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                            [9]: https://web.archive.org/web/20241125024856/https://ss64.com/mac/sysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                            [10]: https://web.archive.org/web/20200418000246/https://stackoverflow.com/questions/17543231/hidden-accounts-on-osx#answer-17552759 "macos - Hidden accounts on OSX - Stack Overflow | stackoverflow.com"
                            [11]: https://archive.ph/2025.01.12-204235/https://github.com/privacysexy-forks/atomic-red-team/blob/master/atomics/T1564.002/T1564.002.md "atomic-red-team/atomics/T1564.002/T1564.002.md at master ¬∑ privacysexy-forks/atomic-red-team ¬∑ GitHub | github.com"
                        call:
                            -oming SSH and SFTP remote logins
                                function: RunInlineCode
                                parameters:/08/16/enable-ssh-mac-command-line/
                                    code: sudo defaults write '/Library/Preferences/com.apple.loginwindow' 'GuestEnabled' -bool NO
                                    revertCode: |- # Does not exist by default since macOS Sonoma 14.5
                                        sudo defaults delete '/Library/Preferences/com.apple.loginwindow' 'GuestEnabled'
                            - insecure TFTP service
                                function: RunIfCommandExists
                                parameters:e Trivial File Transfer Protocol (TFTP), then support for
                                    command: sysadminctl. The information system should be configured to
                                    code: sudo sysadminctl -guestAccount offent the unauthorized connection
                                    # Do not set `on` revert as this is not the default OS state.
                    -ps://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230813
                        name: Disable guest file sharing over SMB
                        recommend: strictable 'system/com.apple.tftpd'
                        docs: |-r multicast advertising
                            This script prevents anonymous (guest) users from accessing files shared over the SMB protocol.
            docs: https://www.stigviewer.com/stig/apple_os_x_10.11/2017-04-06/finding/V-67593
                            By default, macOS allows guest users to access shared folders without authentication [1] [2].true
            revertCode: sudo defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool false
                            macOS allows users to share entire systems or specific folders with others on a network [3].
                            This script impacts only SMB sharing [4], meaning that it has no impact on other file sharing alternatives.
                            SMB (Server Message Block) is a network system that allows computers to share files [4] [5] [6].
                            It is commonly used to share files between Mac and Windows computers [7].
              - https://www.stigviewer.com/stig/apple_os_x_10.10_yosemite_workstation/2017-04-06/finding/V-59671
                            The Guest User feature in macOS lets people temporarily access a Mac without creating standard user accounts [8].
                            Additionally, Guest User accounts on macOS:
      - category: Disable printer sharing (IPP, LDP, SMB and Bonjour protocols)
                            - Do not require a password to log in [8]
                            - Are restricted from changing system settings [8]it's running on
                            - Cannot access the Mac remotely [8]UPS daemon
                            - Automatically delete all files when logging out [8]
                            - Can only use Safari when FileVault encryption is enabled [8]
                            - Enable Mac location through **Find My** app if lost [8]
        children:
                            Disabling SMB guest sharing blocks unauthorized access to shared folders.
                            This improves your security and privacy by preventing unauthorized users from:
            docs: https://www.cups.org/doc/man-cupsctl.html
                            - Accessing your shared files and folders [4] [9]
                            - Performing network reconnaissance [4]
                            - Potentially exploiting system vulnerabilities for privilege escalation [4]
            recommend: standard
                            This security measure is recommended by major security organizations:
            code: cupsctl --no-remote-any
                            - NIST (National Institute of Standards and Technology) - The official US government cybersecurity standards agency [9]
                            - Center for Internet Security (CIS) - A leading nonprofit organization that creates security guidelines used worldwide [4]
            recommend: standard
                            This script may also provide a performance benefit by reducing overhead for guest connections.
            code: cupsctl --no-remote-admin
                            > **Caution:**dmin
                            > After using this script, you must manually add user accounts for anyone who needs to access your shared files [3].
    children:
                            ### Technical Details downloaded files and warns)
        # OS tracks downloaded files with help of quarantine-aware applications
                            The script:ng quarantine extended attributes to files.
        # then OS warns and asks if you really want to open it
                            - Configures the system preference for guest accesscom/en-gb/HT202491
                              (`/Library/Preferences/SystemConfiguration/com.apple.smb.server!AllowGuestAccess`) [4] [9]
                            - Disables SMB guest access using the `sysadminctl` with `-smbGuestAccess off` option [10]
                              `sysadminctl` is a tool used to administer system user accounts [10].
              - name: Clear logs of all downloaded files from File Quarantine
                            [1]: https://web.archive.org/web/20250123200241/https://www.tenable.com/audits/items/CIS_Apple_macOS_11_v1.1.0_L1.audit:153219403c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
                            [2]: https://archive.ph/2025.01.12-201010/https://www.scaprepo.com/view.jsp?id=CCE-50057-9 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
                            [3]: https://web.archive.org/web/20240728041621/https://support.apple.com/en-gb/guide/mac-help/mh17131/mac "Set up file sharing on Mac | support.apple.com"
                            [4]: https://web.archive.org/web/20250113201942/https://www.scaprepo.com/control.jsp?command=relation&relationId=CCE-50149-4 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | scaprepo.com"
                            [5]: https://web.archive.org/web/20241125012504/https://learn.microsoft.com/en-gb/windows/win32/fileio/microsoft-smb-protocol-and-cifs-protocol-overview "Microsoft SMB Protocol and CIFS Protocol Overview | learn.microsoft.com"
                            [6]: https://web.archive.org/web/20241226114905/https://learn.microsoft.com/en-us/windows-server/storage/file-server/file-server-smb-overview "Overview of file sharing using the SMB 3 protocol in Windows Server | learn.microsoft.com"
                            [7]: https://web.archive.org/web/20250113191313/https://www.apple.com/server/docs/File_Services_TB_v10.4.pdf "File Services | High-performance workgroup and Internet file sharingfor Mac, Windows, and Linux clients. | www.apple.com"
                            [8]: https://archive.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                            [9]: https://web.archive.org/web/20240928201604/https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                            [10]: https://web.archive.org/web/20241125024856/https://ss64.com/mac/sysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                        call:elete from LSQuarantineEvent'
                            -b_file" ]; then
                                function: RunInlineCodele\""
                                parameters:| grep --silent 'schg'; then
                                    code: sudo defaults write '/Library/Preferences/SystemConfiguration/com.apple.smb.server' 'AllowGuestAccess' -bool NO
                                    revertCode: |- # Does not exist by default since macOS Sonoma 14.5
                                        sudo defaults delete '/Library/Preferences/SystemConfiguration/com.apple.smb.server' 'AllowGuestAccess'
                            -
                                function: RunIfCommandExistsuchg'; then
                                parameters:hg "$db_file"
                                    command: sysadminctlmmutable flag"
                                    code: sudo sysadminctl -smbGuestAccess off
                                    revertCode: sudo sysadminctl -smbGuestAccess on
                    - sqlite3 "$db_file" "$db_query"
                        name: Disable guest file sharing over AFP
                        recommend: strictmmutable_flag" = true ] ; then
                        docs: |-hflags schg "$db_file"
                            This script prevents anonymous users from accessing shared files through the Apple Filing Protocol (AFP).
                      fi
                            AFP (Apple Filing Protocol) is a file-sharing protocol designed for Macs to facilitate network file sharing [1].
                          sudo chflags uchg "$db_file"
                            By default, macOS enables guest access to sharing services [2] [3].
                            It allows you to share files and folders with others on your network [4].
                            This configuration allows anyone to access specific shared folders without requiring permission [5] [6].
                      echo "No action needed, database does not exist at \"$db_file\""
                            This script improves your privacy by preventing unauthorized users from accessing your shared files through AFP sharing.
                            It also protects your Mac from potential attacks where malicious users can store data in your system [5] or
                            gain increased system access through guest sharing vulnerabilities [7].tine
                code: |-
                            Guest access introduces multiple security risks:
                          -type f         \
                            - Unauthorized users may access shared files [7]
                            - Attackers may fill your hard drive by writing excessive data to guest-accessible folders,
                              potentially causing system crashes [5]
                            - The system may be vulnerable to reconnaissance and privilege escalation attacks [7]
                                      file="{}"
                            This script exclusively affects AFP file sharing [7] and does not impact:
                                          if xattr -d "$attr" "$file" 2>/dev/null; then
                            - File sharing through other protocols [1] [8]rom \"$file\""
                            - Local guest user account functionality [9]
                            - The **Find My app**'s ability to locate your Mac [9]e from \"$file\""
                            - FileVault encryption [9]
                                      else
                            This security measure is recommended by:ile\""
                                      fi
                            - The U.S. National Institute of Standards and Technology (NIST) [8]
                            - The Center for Internet Security (CIS), that provides best practices for securing IT systems [7]
          - category: Disable macOS File Quarantine tracking for downloaded files
                            After running this script, configure access via System Settings to share files with specific users.
              - name: Disable downloaded file logging in quarantine
                            > **Caution:** After running this script, users on your network will require explicit permission to access files shared from your Mac.
                  - https://eclecticlight.co/2019/04/25/%F0%9F%8E%97-quarantine-apps/
                            ### Technical Details/12/11/xattr-com-apple-quarantine-the-quarantine-flag/
                  - https://eclecticlight.co/2017/08/14/show-me-your-metadata-extended-attributes-in-macos-sierra/
                            The script:
                code: |-
                            - Disables guest access in AFP server preferences:QuarantineEventsV2
                              `/Library/Preferences/com.apple.AppleFileServer!guestAccess` [5] [6] [7] [8] [10].
                            - Disables AFP guest access using the `sysadminctl` utility with the `-afpGuestAccess off` option [11]
                              `sysadminctl` is a tool used to administer system user accounts [11].
                            - Restarts the file sharing service (`AppleFileServer`) to apply changes [5] [10]
                      echo "No action is needed, file does not exist at \"$file_to_lock\""
                            [1]: https://web.archive.org/web/20250113191313/https://www.apple.com/server/docs/File_Services_TB_v10.4.pdf "File Services | High-performance workgroup and Internet file sharingfor Mac, Windows, and Linux clients. | www.apple.com"
                            [2]: https://web.archive.org/web/20250123200241/https://www.tenable.com/audits/items/CIS_Apple_macOS_11_v1.1.0_L1.audit:153219403c9d852b574cc5ef59902392 "6.1.3 Disable guest account login | Tenable¬Æ | www.tenable.com"
                            [3]: https://archive.ph/2025.01.12-201010/https://www.scaprepo.com/view.jsp?id=CCE-50057-9 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | www.scaprepo.com"
                            [4]: https://web.archive.org/web/20240728041621/https://support.apple.com/en-gb/guide/mac-help/mh17131/mac "Set up file sharing on Mac | support.apple.com"
                            [5]: https://web.archive.org/web/20240421151410/https://events.ccc.de/congress/2004/fahrplan/files/95-macosx-insecurity-paper.pdf "Practical Mac OS X Insecurity Security Concepts, Problems, and Exploits on Your Mac | cdn2.qualys.com/docs/release-notes | events.ccc.de"
                            [6]: https://web.archive.org/web/20071102090442/http://www.princeton.edu:80/~psg/unix/osx/osxsecurity.html "OS X Security | www.princeton.edu"
                            [7]: https://web.archive.org/web/20250113201942/https://www.scaprepo.com/control.jsp?command=relation&relationId=CCE-50149-4 "SecPod SCAP Repo, a repository of SCAP Content (CVE, CCE, CPE, CWE, OVAL and XCCDF) | scaprepo.com"
                            [8]: https://web.archive.org/web/20240928201604/https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-179.pdf "NIST Special Publication 800-179 (December 2016) | nvlpubs.nist.gov"
                            [9]: https://archive.ph/2025.01.12-195712/https://support.apple.com/guide/mac-help/aside/glos8c20ac45/15.0/mac/15.0 "Guest user - Apple Support | support.apple.com"
                            [10]: https://web.archive.org/web/20250123203912/https://cdn2.qualys.com/docs/release-notes/qualys-api-rti.pdf "Qualys API Release Notes | cdn2.qualys.com"
                            [11]: https://web.archive.org/web/20241125024856/https://ss64.com/mac/sysadminctl.html "bg Man Page - macOS - SS64.com | ss64.com"
                        call:cation Downloaded from Internet" quarantine warning.
                            -
                                function: RunInlineCodestions/373176/disable-the-use-of-the-com-apple-quarantine-extended-attribute-on-mojave
                                parameters:uestions/266176/is-there-some-way-to-disable-the-dialogs-shown-when-opening-an-application-for-t
                                    code: sudo defaults write '/Library/Preferences/com.apple.AppleFileServer' 'guestAccess' -bool NO
                                    revertCode: |- # Does not exist by default since macOS Sonoma 14.5
                                        sudo defaults delete '/Library/Preferences/com.apple.AppleFileServer' 'guestAccess'
                            -ekeeper (enforces code-signing)
                                function: RunIfCommandExistsning for apps.
                                parameters:d by its developer with certificate issued by Apple.
                                    command: sysadminctl
                                    code: sudo sysadminctl -afpGuestAccess off
                                    revertCode: sudo sysadminctl -afpGuestAccess on
                            -
                                function: RunInlineCodetekeeper-auto-rearm-mac-os-x/
                                parameters:/20230327050142/https://www.cnet.com/tech/computing/how-to-disable-gatekeeper-permanently-on-os-x/
                                    # Service needs restart to apply changes in both enable/disable cases
                                    # sudo required to kill a process that's not owned by the userool false
                                    code: sudo killall -HUP AppleFileServer
                                    revertCode: sudo killall -HUP AppleFileServer
            - # References for spctl --master-disable
                category: Disable unauthorized connections/https://www.manpagez.com/man/8/spctl/
                children:s for /var/db/SystemPolicy-prefs.plist
                    -://web.archive.org/web/20240810103202/https://krypted.com/mac-security/manage-gatekeeper-from-the-command-line-in-mountain-lion/
                        name: Disable incoming SSH and SFTP remote logins-password-greyed-out/m-p/54228
                        recommend: standard
                        docs: https://osxdaily.com/2016/08/16/enable-ssh-mac-command-line/
                        # Check if enabled: sudo systemsetup -getremotelogin, returns "Remote Login: On" or "Off"
                        code: echo 'yes' | sudo systemsetup -setremotelogin off
                        revertCode: sudo systemsetup -setremotelogin on) \
                    - then
                        name: Disable the insecure TFTP serviceilable this OS version"
                        recommend: standard
                        # If the system does not require Trivial File Transfer Protocol (TFTP), then support for
                        # it is non-essential and should be disabled. The information system should be configured to
                        # provide only essential capabilities. Disabling TFTP helps prevent the unauthorized connection
                        # of devices and the unauthorized transfer of information.
                        docs: https://www.stigviewer.com/stig/apple_macos_11_big_sur/2021-06-16/finding/V-230813
                        code: sudo launchctl disable 'system/com.apple.tftpd'ed' -string 'no'
                        revertCode: sudo launchctl enable 'system/com.apple.tftpd'
                    -e
                        name: Disable Bonjour multicast advertisingper_status"
                        recommend: standard
                        docs: https://www.stigviewer.com/stig/apple_os_x_10.11/2017-04-06/finding/V-67593
                        code: sudo defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool true
                        revertCode: sudo defaults write /Library/Preferences/com.apple.mDNSResponder.plist NoMulticastAdvertisements -bool false
                    -r_ver=$(sw_vers -productVersion | awk -F "." '{print $2}')
                        name: Disable insecure telnet protocol
                        recommend: standardq 10 && $os_minor_ver -lt 7 ) \
                        docs:
                            - https://www.stigviewer.com/stig/apple_os_x_10.13/2020-09-11/finding/V-214882
                            - https://www.stigviewer.com/stig/apple_os_x_10.10_yosemite_workstation/2017-04-06/finding/V-59671
                        code: sudo launchctl disable system/com.apple.telnetdrint $2}')"
                        revertCode: sudo launchctl enable system/com.apple.telnetd
            -         sudo spctl --master-enable
                category: Disable printer sharing (IPP, LDP, SMB and Bonjour protocols)g 'yes'
                # Used typically for serverser"
                # By default, the CUPS only listens to requests from the machine that it's running on
                # cupsctl is a tool to manage the configuration of the CUPS daemon
                docs:e
                    - https://www.cups.org/doc/sharing.html$gatekeeper_status"
                    - https://www.cups.org/doc/security.html # Security risks
                children:
                    - library validation entitlement (library signature validation)
                        name: Disable local printer sharing with other computers
                        recommend: standarditlement | Apple Developer Documentation | developer.apple.com](https://archive.ph/2024.07.19-101811/https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_disable-library-validation)
                        docs: https://www.cups.org/doc/man-cupsctl.html//web.archive.org/web/20240625020749/https://www.naut.ca/blog/2020/11/13/forbidden-commands-to-liberate-macos/)
                        code: cupsctl --no-share-printershive.org/web/20220622212008/https://www.macenhance.com/docs/general/sip-library-validation.html)
                        revertCode: cupsctl --share-printerspple.security.libraryvalidation.plist 'DisableLibraryValidation' -bool true
                    -udo defaults write /Library/Preferences/com.apple.security.libraryvalidation.plist 'DisableLibraryValidation' -bool false
                        name: Disable printing from external addresses, including the internet
                        recommend: standard
                        docs: https://www.cups.org/doc/man-cupsctl.html system updates.
                        code: cupsctl --no-remote-any
                        revertCode: cupsctl --remote-anyontrol over when and which updates are applied to their system.
                    - privacy by preventing unwanted data collection, new vulnerabilities and unapproved changes to system settings.
                        name: Disable remote printer administration
                        recommend: standard
                        docs: https://www.cups.org/doc/man-cupsctl.htmle to unpatched exploits.
                        code: cupsctl --no-remote-adminotected.
                        revertCode: cupsctl --remote-admin
    -     - name: Disable automatic checks for updates
        category: Privacy over security24.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate
        children: |-
            - # For OS X Yosemite and newer (>= 10.10)
                category: Disable File Quarantine (tracks downloaded files and warns)maticCheckEnabled' -bool false
                # OS tracks downloaded files with help of quarantine-aware applications
                # (such as Safari, Chrome) adding quarantine extended attributes to files.
                # then OS warns and asks if you really want to open itareUpdate 'AutomaticCheckEnabled' -bool true
                docs: https://web.archive.org/web/20210319081714/https://support.apple.com/en-gb/HT202491
                children:/archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate
                    -
                        category: Clean File Quarantine from downloaded files
                        children: /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticDownload' -bool false
                            -
                                name: Clear logs of all downloaded files from File Quarantine
                                recommend: strictences/com.apple.SoftwareUpdate 'AutomaticDownload' -bool true
                                docs:nstallation of macOS updates
                                    - https://www.macobserver.com/tips/how-to/your-mac-remembers-everything-you-download-heres-how-to-clear-download-history/
                                    - https://eclecticlight.co/2019/04/25/%F0%9F%8E%97-quarantine-apps/
                                    - https://eclecticlight.co/2017/12/11/xattr-com-apple-quarantine-the-quarantine-flag/
                                    - https://eclecticlight.co/2017/08/14/show-me-your-metadata-extended-attributes-in-macos-sierra/
                                    # Query entries using:
                                    #   sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 'select DISTINCT LSQuarantineDataURLString from LSQuarantineEvent'
                                code: |-curity (CIS) advises against automatic updates in scenarios where changes require
                                    db_file=~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
                                    db_query='delete from LSQuarantineEvent'
                                    if [ -f "$db_file" ]; thenrom installing updates automatically:
                                        echo "Database exists at \"$db_file\""
                                        if ls -lO "$db_file" | grep --silent 'schg'; then
                                            sudo chflags noschg "$db_file"alling macOS updates [1] [2] [3] [4] [5] [6] [7] [8].
                                            echo "Found and removed system immutable flag"u a chance to check them first [1] [2] [3] [4] [5] [6] [7] [8].
                                            has_system_immutable_flag=true Sierra [7] [9].
                                        fi
                                        if ls -lO "$db_file" | grep --silent 'uchg'; thens`:
                                            sudo chflags nouchg "$db_file"s automatically [3] [5] [9] [10], giving you control over when to update.
                                            echo "Found and removed user immutable flag"from changing the option [10].
                                            has_user_immutable_flag=truet advised by NIST due to potential security risks [9].
                                        fimacOS Mojave and newer versions [9].
                                        sqlite3 "$db_file" "$db_query"
                                        echo "Executed the query \"$db_query\""ly check and apply updates to stay protected against security threats [1] [2] [3] [4].
                                        if [ "$has_system_immutable_flag" = true ] ; then
                                            sudo chflags schg "$db_file"w.tenable.com/audits/items/CIS_Apple_macOS_10.12_v1.1.0_Level_1.audit:e02dfdd6bec9556a3ce537f60b91b549 "CIS Apple macOS 10.12 L1 v1.1.0 | 1.5 Enable OS X update installs | Tenable¬Æ"
                                            echo "Added system immutable flag back"e.com/Security/CIS/CIS_Apple_macOS_10_13_Benchmark_v1_1_0---PDF.pdf "CIS Apple macOS 10.13 Benchmark v1.1.0 | paper.bobylive.com"
                                        fi/web/20240321170400/https://www.tenable.com/audits/items/CIS_Apple_macOS_13.0_Ventura_v1.0.0_L1.audit:fe03c59a39c7c949507ff20d07f89993 "1.4 Ensure Install of macOS Updates Is Enabled | Tenable¬Æ | www.tenable.com"
                                        if [ "$has_user_immutable_flag" = true ] ; thenm/Security/CIS/CIS_Apple_macOS_10_14_Benchmark_v1_4_0_PDF.pdf "CIS Apple macOS 10.14 Benchmark v1.4.0 | paper.bobylive.com"
                                            sudo chflags uchg "$db_file"w.ncsc.gov.uk/files/macos_provisioning_script.sh_.txt "macOS provisioning script | UK National Cyber Security Centre | www.ncsc.gov.uk"
                                            echo "Added user immutable flag back"c.readthedocs.io/en/master/Profiles-and-Settings/OS-X-Updates.html "macOS Updates ‚Äî MacAdmins Community Documentation documentation | macadminsdoc.readthedocs.io"
                                        fi/web/20240321165304/https://derflounder.wordpress.com/2014/12/29/managing-automatic-app-store-and-os-x-update-installation-on-yosemite/ "Managing automatic App Store and OS X update installation on Yosemite | Der Flounder | derflounder.wordpress.com"
                                    elserg/web/20240321170034/https://krypted.com/mac-os-x/app-store-preferences-set-server-5-4-macos-high-sierra/ "App Store Preferences To Set In On Server 5.4 for macOS High Sierra ‚Äì krypted | krypted.com"
                                        echo "No action needed, database does not exist at \"$db_file\""28/enabling-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/ "Enabling automatic macOS software updates for OS X Yosemite through macOS Mojave | Der Flounder | derflounder.wordpress.com"
                                    fi/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"
                            -eb.archive.org/web/20240321165931/https://csrc.nist.gov/CSRC/media/Projects/national-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"
                                name: Clear File Quarantine attribute from downloaded files
                                docs: https://superuser.com/questions/28384/what-should-i-do-about-com-apple-quarantine
                                code: |-ry/Preferences/com.apple.commerce 'AutoUpdateRestartRequired' -bool false
                                    find ~/Downloads        \
                                            -type f         \ple.SoftwareUpdate 'AutomaticallyInstallMacOSUpdates' -bool false
                                            -exec           \
                                                sh -c       \>= 10.10 && < 10.14)
                                                    's/com.apple.commerce 'AutoUpdateRestartRequired' -bool true
                                                        attr="com.apple.quarantine"
                                                        file="{}"SoftwareUpdate 'AutomaticallyInstallMacOSUpdates' -bool true
                                                        if [[ $(xattr "$file") = *$attr* ]]; then
                                                            if xattr -d "$attr" "$file" 2>/dev/null; then
                                                                echo "üßπ Cleaned attribute from \"$file\""] [9] [10] [11] [12] [13].
                                                            elseupdates as soon as they become available from Apple [2] [3] [6] [9] [11] [12] [13].
                                                                >&2 echo "‚ùå Failed to clean attribute from \"$file\""
                                                            fi
                                                        elsed app behavior or settings changes.
                                                            echo "No attribute in \"$file\""
                                                        fivulnerabilities in your apps.
                                                    '       \tes to install and when, enabling you to review the details of updates before deciding to proceed.
                                                {} \;
                    -ipt modifies the following settings:
                        category: Disable macOS File Quarantine tracking for downloaded files
                        children:ences/com.apple.commerce!AutoUpdate`:
                            -tomated app updates [1] [2] [3] [6] [9] [10] [13] from the App Store [7] [8].
                                name: Disable downloaded file logging in quarantine
                                docs:s/com.apple.SoftwareUpdate!AutomaticallyInstallAppUpdates`:
                                    - https://eclecticlight.co/2019/04/25/%F0%9F%8E%97-quarantine-apps/[12] [13].
                                    - https://eclecticlight.co/2017/12/11/xattr-com-apple-quarantine-the-quarantine-flag/e option [10].
                                    - https://eclecticlight.co/2017/08/14/show-me-your-metadata-extended-attributes-in-macos-sierra/
                                recommend: strictojave and newer versions [1].
                                code: |-
                                    file_to_lock=~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
                                    if [ -f "$file_to_lock" ]; thenck for and install important security patches for every application
                                        sudo chflags schg "$file_to_lock"1] [12] [13].
                                        echo "Made file immutable at \"$file_to_lock\""
                                    elserg/web/20240321170251/https://derflounder.wordpress.com/2018/12/28/enabling-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/ "Enabling automatic macOS software updates for OS X Yosemite through macOS Mojave | Der Flounder | derflounder.wordpress.com"
                                        echo "No action is needed, file does not exist at \"$file_to_lock\""em-macosx-v6-1-093021.xlsx "SCSEM OSX 10.14 | Internal Revenue Service Office of Safeguards | www.irs.gov"
                                    fi.org/web/20240321170036/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_10_14_Benchmark_v1_4_0_PDF.pdf "CIS Apple macOS 10.14 Benchmark v1.4.0 | paper.bobylive.com"
                                revertCode: |-/20240321190244/https://github-wiki-see.page/m/edamametechnologies/threatmodels/wiki/threatmodel-macOS-EN "threatmodel macOS EN - edamametechnologies/threatmodels GitHub Wiki | github-wiki-see.page"
                                    file_to_lock=~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2_14.0_Sonoma_v1.0.0_L1.audit:66d3b86318384ba7947a3409e0c6e902 "1.5 Ensure Install Application Updates from the App Store Is E... | Tenable¬Æ | www.tenable.com"
                                    if [ -f "$file_to_lock" ]; then://derflounder.wordpress.com/2014/12/29/managing-automatic-app-store-and-os-x-update-installation-on-yosemite/ "Managing automatic App Store and OS X update installation on Yosemite | Der Flounder | derflounder.wordpress.com"
                                        sudo chflags noschg "$file_to_lock"ed.com/mac-security/app-store-preferences-set-server-5-2-macos-sierra/ "App Store Preferences To Set In On Server 5.2 for macOS Sierra ‚Äì krypted | krypted.com"
                                        echo "Successfully reverted immutability from \"$file_to_lock\""national-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"
                                    elserg/web/20240321190114/https://www.irs.gov/pub/irs-utl/safeguards-scsem-macosx.xlsx "SCSEM OSX 13.0 | Internal Revenue Service Office of Safeguards | www.irs.gov"
                                        >&2 echo "Cannot revert immutability, file does not exist at\"$file_to_lock\""ftwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"
                                    fie.org/web/20240321190122/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_12_0_Monterey_Benchmark_v1_0_0.pdf "CIS Apple macOS 12.0 Monterey | CIS Benchmarks | paper.bobylive.com"
                            -eb.archive.org/web/20240321190537/https://www.tenable.com/audits/items/CIS_Apple_macOS_11_v2.0.0_L1.audit:55e8759872dce781b8dbc5a3f42e23b9 "1.4 Ensure Installation of App Update Is Enabled | Tenable¬Æ | www.tenable.com"
                                name: Disable extended quarantine attribute for downloaded files (disables warning)ipt.sh_.txt "macOS provisioning script | UK National Cyber Security Centre | www.ncsc.gov.uk"
                                # Disables dialogs shown when opening an application for the first time
                                # i.e. "Application Downloaded from Internet" quarantine warning.
                                docs:brary/Preferences/com.apple.commerce 'AutoUpdate' -bool false
                                    - https://apple.stackexchange.com/questions/373176/disable-the-use-of-the-com-apple-quarantine-extended-attribute-on-mojave
                                    - https://superuser.com/questions/266176/is-there-some-way-to-disable-the-dialogs-shown-when-opening-an-application-for-t
                                    - https://macos-defaults.com/misc/lsquarantine.html
                                code: sudo defaults write com.apple.LaunchServices 'LSQuarantine' -bool NO
                                revertCode: sudo defaults delete com.apple.LaunchServices 'LSQuarantine'
            - # For Mojave and newer (>= 10.14)
                category: Disable Gatekeeper (enforces code-signing)twareUpdate 'AutomaticallyInstallAppUpdates' -bool true
                # Built on top of File Quarantine, requires code-signing for apps.
                # Warns user if a file is not signed by its developer with certificate issued by Apple.
                # Can protect against unknown threats.
                children:Yosemite and newer (>= 10.10)
                    -faults write /Library/Preferences/com.apple.SoftwareUpdate 'AllowPreReleaseInstallation' -bool false
                        name: Disable Gatekeeper's automatic reactivation
                        docs:mite and newer (>= 10.10)
                            - https://osxdaily.com/2015/11/05/stop-gatekeeper-auto-rearm-mac-os-x/stallation' -bool true
                            - https://web.archive.org/web/20230327050142/https://www.cnet.com/tech/computing/how-to-disable-gatekeeper-permanently-on-os-x/
                        code: sudo defaults write /Library/Preferences/com.apple.security GKAutoRearm -bool trueng-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/
                        revertCode: sudo defaults write /Library/Preferences/com.apple.security GKAutoRearm -bool false
                    -S X Yosemite and newer (>= 10.10)
                        name: Disable Gatekeeperrences/com.apple.SoftwareUpdate 'ConfigDataInstall' -bool false
                        docs:
                            # References for spctl --master-disable
                                - https://web.archive.org/web/20240523173608/https://www.manpagez.com/man/8/spctl/
                            # References for /var/db/SystemPolicy-prefs.plistcurity updates
                                - https://web.archive.org/web/20240810103202/https://krypted.com/mac-security/manage-gatekeeper-from-the-command-line-in-mountain-lion/
                                - https://community.jamf.com/t5/jamf-pro/users-can-t-change-password-greyed-out/m-p/54228
                        code: |- [1] [2] [3] [4] [5] [6] [7] and system data file [1] [8] updates.
                            os_major_ver=$(sw_vers -productVersion | awk -F "." '{print $1}')
                            os_minor_ver=$(sw_vers -productVersion | awk -F "." '{print $2}')
                            if [[ $os_major_ver -le 10 \
                                    || ( $os_major_ver -eq 10 && $os_minor_ver -lt 7 ) \
                                ]]; then before installation to ensure they meet privacy standards and do not introduce
                                echo "No action needed, Gatekeeper is not available this OS version"
                            elseal Communications**:
                                gatekeeper_status="$(spctl --status | awk '/assessments/ {print $2}')"on.
                                if [ $gatekeeper_status = "disabled" ]; then
                                    echo "No action needed, Gatekeeper is already disabled"icalUpdateInstall` setting [1] [4] [5] [7] [8].
                                elif [ $gatekeeper_status = "enabled" ]; thenpdates [1].
                                    sudo spctl --master-disablesystem data files and security updates option manually [1].
                                    sudo defaults write '/var/db/SystemPolicy-prefs' 'enabled' -string 'no'
                                    echo "Disabled Gatekeeper"
                                elsegers `softwareupdate --background-critical` to install any pending critical updates directly [2] [9].
                                    >&2 echo "Unknown gatekeeper status: $gatekeeper_status"
                                fi
                            fiutomatic updates if you're committed to manually installing them quickly to maintain your computer's security [4] [5] [8].
                        revertCode: |-all updates soon to protect your computer. [4] [5] [8].
                            os_major_ver=$(sw_vers -productVersion | awk -F "." '{print $1}')
                            os_minor_ver=$(sw_vers -productVersion | awk -F "." '{print $2}')
                            if [[ $os_major_ver -le 10 \
                                    || ( $os_major_ver -eq 10 && $os_minor_ver -lt 7 ) \computer safe from new threats [5].
                                ]]; thennse** [10] [11].
                                >&2 echo "Gatekeeper is not available in this OS version"security improvements between standard updates [12].
                            else
                                gatekeeper_status="$(spctl --status | awk '/assessments/ {print $2}')"cemanagement/softwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"
                                if [ $gatekeeper_status = "disabled" ]; thenunder.wordpress.com/2014/12/24/managing-os-xs-automatic-security-updates/ "Managing OS X‚Äôs automatic security updates | Der Flounder | derflounder.wordpress.com"
                                    sudo spctl --master-enablehttps://macadminsdoc.readthedocs.io/en/master/Profiles-and-Settings/OS-X-Updates.html "macOS Updates ‚Äî MacAdmins Community Documentation documentation | macadminsdoc.readthedocs.io"
                                    sudo defaults write '/var/db/SystemPolicy-prefs' 'enabled' -string 'yes'onal-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"
                                    echo "Enabled Gatekeeper"/https://paper.bobylive.com/Security/CIS/CIS_Apple_OSX_10_9_Benchmark_v1_3_0.pdf "CIS Apple OSX 10.9 Benchmark | paper.bobylive.com"
                                elif [ $gatekeeper_status = "enabled" ]; thennder.wordpress.com/2014/12/27/managing-automatic-installation-of-configdata-and-security-software-updates-on-yosemite/ "Managing automatic installation of ConfigData and security software updates on Yosemite | Der Flounder | derflounder.wordpress.com"
                                    echo "No action needed, Gatekeeper is already enabled"defaults.html "System preference settings for macOS - macOS - SS64.com | ss64.com"
                                elseve.org/web/20240321201436/https://www.tenable.com/audits/items/CIS_OSX_10.10_v1.2.0_L1.audit:97f36c2eaa06045e85a1beff1a76a088 "1.4 Enable system data files and security update installs - 'C... | Tenable¬Æ | www.tenable.com"
                                    >&2 echo "Unknown gatekeeper status: $gatekeeper_status"com/2013/04/30/undocumented-options/ "Undocumented options ‚Äì Managing OS X | managingosx.wordpress.com"
                                fichive.org/web/20240321201558/https://www.intuneirl.com/rapid-security-response/ "Managing Rapid Security Response on Apple Devices | www.intuneirl.com"
                            fib.archive.org/web/20240321201614/https://onsitegroup.co.za/rapid-security-response/ "Rapid security response - Onsite | onsitegroup.co.za"
            - [12]: https://web.archive.org/web/20240321201623/https://support.apple.com/en-us/102657 "About Rapid Security Responses for iOS, iPadOS, and macOS - Apple Support | support.apple.com"
                name: Disable library validation entitlement (library signature validation)
                docs: |- Yosemite and newer (>= 10.10)
                    - [Disable Library Validation Entitlement | Apple Developer Documentation | developer.apple.com](https://archive.ph/2024.07.19-101811/https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_disable-library-validation)
                    - [Forbidden Commands to Speed Up macOS | www.naut.ca](https://web.archive.org/web/20240625020749/https://www.naut.ca/blog/2020/11/13/forbidden-commands-to-liberate-macos/)
                    - [macEnhance | macEnhance.com](https://web.archive.org/web/20220622212008/https://www.macenhance.com/docs/general/sip-library-validation.html)
                code: sudo defaults write /Library/Preferences/com.apple.security.libraryvalidation.plist 'DisableLibraryValidation' -bool true
                revertCode: sudo defaults write /Library/Preferences/com.apple.security.libraryvalidation.plist 'DisableLibraryValidation' -bool false
            - sudo softwareupdate --background-critical
                category: Disable automatic updates
                docs: |-ironmentConfiguration
                    This category contains scripts to disable automatic operating system updates.
      - name: configuration
                    Disabling automatic updates gives users full control over when and which updates are applied to their system.
                    It improves privacy by preventing unwanted data collection, new vulnerabilities and unapproved changes to system settings.
      declare -a profile_files=("$HOME/.bash_profile" "$HOME/.zprofile")
                    > **Caution**:le_files[@]}"
                    > Disabling automatic updates can leave your system vulnerable to unpatched exploits.
                    > Manually check and apply updates to stay protected.
                children:command" "${profile_file}"; then
                    -command" >> "$profile_file"
                        name: Disable automatic checks for updates
                        docs: https://archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate
                        code: |-le] No need for any action, already configured"
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticCheckEnabled' -bool false
                        revertCode: |-
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticCheckEnabled' -bool true
                    -e in "${profile_files[@]}"
                        name: Disable automatic downloads for updates
                        docs: https://archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate
                        code: |-nd/d" "$profile_file"
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticDownload' -bool false
                        revertCode: |- need for any action, configuration does not exist"
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticDownload' -bool true
                    -dExists # Skips if command does not exist
                        name: Disable automatic installation of macOS updates
                        docs: |-
                            This script stops macOS from automatically installing updates.
      - name: command
                            This script improves privacy by reducing unwanted data collection and ensuring updates don't change
                            settings or data without your approval.
        optional: true
                            The Center for Internet Security (CIS) advises against automatic updates in scenarios where changes require
                            thorough testing and approval processes to avoid operational disruptions [1] [2] [3] [4].
          echo 'Skipping because "{{ $command }}" is not found.'
                            This script configures following to stop macOS from installing updates automatically:
          {{ $code }}
                            1. `/Library/Preferences/com.apple.commerce!AutoUpdateRestartRequired`:
                                This preference stops the system from automatically installing macOS updates [1] [2] [3] [4] [5] [6] [7] [8].
                                By doing this, updates will only be installed when you decide, giving you a chance to check them first [1] [2] [3] [4] [5] [6] [7] [8].
                                This setting applies to OS X Yosemite through macOS High Sierra [7] [9].
              >&2 echo 'Cannot revert because "{{ $command }}" is not found.'
                            2. `/Library/Preferences/com.apple.commerce!AutomaticallyInstallMacOSUpdates`:
                                Changing this setting stops macOS from installing updates automatically [3] [5] [9] [10], giving you control over when to update.
                                If restricts the *Install macOS Updates* option and prevents the user from changing the option [10].
                                While this setting enhances privacy, it's generally not advised by NIST due to potential security risks [9].
                                This setting applies to macOS Mojave and newer versions [9].
    parameters:
                            > **Caution**: Disabling automatic updates requires you to manually check and apply updates to stay protected against security threats [1] [2] [3] [4].
    docs: |-
                            [1]: https://web.archive.org/web/20240321165149/https://www.tenable.com/audits/items/CIS_Apple_macOS_10.12_v1.1.0_Level_1.audit:e02dfdd6bec9556a3ce537f60b91b549 "CIS Apple macOS 10.12 L1 v1.1.0 | 1.5 Enable OS X update installs | Tenable¬Æ"
                            [2]: https://web.archive.org/web/20240321165851/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_10_13_Benchmark_v1_1_0---PDF.pdf "CIS Apple macOS 10.13 Benchmark v1.1.0 | paper.bobylive.com"
                            [3]: https://web.archive.org/web/20240321170400/https://www.tenable.com/audits/items/CIS_Apple_macOS_13.0_Ventura_v1.0.0_L1.audit:fe03c59a39c7c949507ff20d07f89993 "1.4 Ensure Install of macOS Updates Is Enabled | Tenable¬Æ | www.tenable.com"
                            [4]: https://web.archive.org/web/20240321170036/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_10_14_Benchmark_v1_4_0_PDF.pdf "CIS Apple macOS 10.14 Benchmark v1.4.0 | paper.bobylive.com"
                            [5]: https://web.archive.org/web/20240321164917/https://www.ncsc.gov.uk/files/macos_provisioning_script.sh_.txt "macOS provisioning script | UK National Cyber Security Centre | www.ncsc.gov.uk"
                            [6]: https://web.archive.org/web/20240321165118/https://macadminsdoc.readthedocs.io/en/master/Profiles-and-Settings/OS-X-Updates.html "macOS Updates ‚Äî MacAdmins Community Documentation documentation | macadminsdoc.readthedocs.io"
                            [7]: https://web.archive.org/web/20240321165304/https://derflounder.wordpress.com/2014/12/29/managing-automatic-app-store-and-os-x-update-installation-on-yosemite/ "Managing automatic App Store and OS X update installation on Yosemite | Der Flounder | derflounder.wordpress.com"
                            [8]: https://web.archive.org/web/20240321170034/https://krypted.com/mac-os-x/app-store-preferences-set-server-5-4-macos-high-sierra/ "App Store Preferences To Set In On Server 5.4 for macOS High Sierra ‚Äì krypted | krypted.com"
                            [9]: https://web.archive.org/web/20240321170251/https://derflounder.wordpress.com/2018/12/28/enabling-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/ "Enabling automatic macOS software updates for OS X Yosemite through macOS Mojave | Der Flounder | derflounder.wordpress.com"
                            [10]: https://archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"
                            [11]: https://web.archive.org/web/20240321165931/https://csrc.nist.gov/CSRC/media/Projects/national-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"
                        code: |-util reset "$serviceId" 2>&1)
                            # For OS X Yosemite through macOS High Sierra (>= 10.10 && < 10.14)
                            sudo defaults write /Library/Preferences/com.apple.commerce 'AutoUpdateRestartRequired' -bool false
                            # For Mojave and newer (>= 10.14)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticallyInstallMacOSUpdates' -bool false
                        revertCode: |-70 ]; then
                            # For OS X Yosemite through macOS High Sierra (>= 10.10 && < 10.14)stem version."
                            sudo defaults write /Library/Preferences/com.apple.commerce 'AutoUpdateRestartRequired' -bool true
                            # For Mojave and newer (>= 10.14)erviceId}\". Exit code: $reset_exit_code."
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticallyInstallMacOSUpdates' -bool true
                    -o "Output from \`tccutil\`: $reset_output."
                        name: Disable automatic app updates from the App Store
                        docs: |-
                            This script disables automatic app updates [1] [2] [3] [4] from the App Store [5] [6] [7] [8] [9] [10] [11] [12] [13].
                            It prevents automatic installation of application updates as soon as they become available from Apple [2] [3] [6] [9] [11] [12] [13].
                            Thus, applications are updated only when you choose to do so [5].
    parameters:
                            Disabling automatic updates prevents unexpected app behavior or settings changes.
                            It helps you to maintain your current app configurations and privacy settings.
                            It also protects against potential zero-day vulnerabilities in your apps.
                            This gives you the ability to choose which updates to install and when, enabling you to review the details of updates before deciding to proceed.
    revertCode: "{{ with $revertCode }}{{ . }}{{ end }}"
                            The script modifies the following settings:
    # üí° Purpose:
                            1. `/Library/Preferences/com.apple.commerce!AutoUpdate`:
                                Disables automated app updates [1] [2] [3] [6] [9] [10] [13] from the App Store [7] [8].
                                This setting applies to OS X Yosemite and newer versions [1].
                            2. `/Library/Preferences/com.apple.SoftwareUpdate!AutomaticallyInstallAppUpdates`:
                                Stops the automatic installation of app updates [1] [4] from App Store [9] [10] [11] [12] [13].
                                It deselects the *Install app updates from the App Store* option and prevents the user from changing the option [10].
                                While this setting enhances privacy, it's generally not advised by NIST due to potential security risks [4].
                                This setting applies to macOS Mojave and newer versions [1].
        optional: true
                            > **Caution**:
                            > Disabling app updates means you should manually check for and install important security patches for every application
                            > to protect against vulnerabilities [2] [3] [5] [6] [9] [11] [12] [13].
        code: "{{ with $codeComment }}# {{ . }}{{ end }}"
                            [1]: https://web.archive.org/web/20240321170251/https://derflounder.wordpress.com/2018/12/28/enabling-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/ "Enabling automatic macOS software updates for OS X Yosemite through macOS Mojave | Der Flounder | derflounder.wordpress.com"
                            [2]: https://web.archive.org/web/20240321190032/https://www.irs.gov/pub/irs-utl/safeguards-scsem-macosx-v6-1-093021.xlsx "SCSEM OSX 10.14 | Internal Revenue Service Office of Safeguards | www.irs.gov"
                            [3]: https://web.archive.org/web/20240321170036/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_10_14_Benchmark_v1_4_0_PDF.pdf "CIS Apple macOS 10.14 Benchmark v1.4.0 | paper.bobylive.com"
                            [5]: https://web.archive.org/web/20240321190244/https://github-wiki-see.page/m/edamametechnologies/threatmodels/wiki/threatmodel-macOS-EN "threatmodel macOS EN - edamametechnologies/threatmodels GitHub Wiki | github-wiki-see.page"
                            [6]: https://web.archive.org/web/20240321190315/https://www.tenable.com/audits/items/CIS_Apple_macOS_14.0_Sonoma_v1.0.0_L1.audit:66d3b86318384ba7947a3409e0c6e902 "1.5 Ensure Install Application Updates from the App Store Is E... | Tenable¬Æ | www.tenable.com"
                            [7]: https://web.archive.org/web/20240321165304/https://derflounder.wordpress.com/2014/12/29/managing-automatic-app-store-and-os-x-update-installation-on-yosemite/ "Managing automatic App Store and OS X update installation on Yosemite | Der Flounder | derflounder.wordpress.com"
                            [8]: https://web.archive.org/web/20240321190410/https://krypted.com/mac-security/app-store-preferences-set-server-5-2-macos-sierra/ "App Store Preferences To Set In On Server 5.2 for macOS Sierra ‚Äì krypted | krypted.com"
                            [4]: https://web.archive.org/web/20240321165931/https://csrc.nist.gov/CSRC/media/Projects/national-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"
                            [9]: https://web.archive.org/web/20240321190114/https://www.irs.gov/pub/irs-utl/safeguards-scsem-macosx.xlsx "SCSEM OSX 13.0 | Internal Revenue Service Office of Safeguards | www.irs.gov"
                            [10]: https://archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"
                            [11]: https://web.archive.org/web/20240321190122/https://paper.bobylive.com/Security/CIS/CIS_Apple_macOS_12_0_Monterey_Benchmark_v1_0_0.pdf "CIS Apple macOS 12.0 Monterey | CIS Benchmarks | paper.bobylive.com"
                            [12]: https://web.archive.org/web/20240321190537/https://www.tenable.com/audits/items/CIS_Apple_macOS_11_v2.0.0_L1.audit:55e8759872dce781b8dbc5a3f42e23b9 "1.4 Ensure Installation of App Update Is Enabled | Tenable¬Æ | www.tenable.com"
                            [13]: https://web.archive.org/web/20240321164917/https://www.ncsc.gov.uk/files/macos_provisioning_script.sh_.txt "macOS provisioning script | UK National Cyber Security Centre | www.ncsc.gov.uk"
                        code: |-
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.commerce 'AutoUpdate' -bool false
                            # For Mojave and newer (>= 10.14)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticallyInstallAppUpdates' -bool false
                        revertCode: |- }}/*"
                            # For OS X Yosemite and newertrue{{ end }}"
                            sudo defaults write /Library/Preferences/com.apple.commerce 'AutoUpdate' -bool true
                            # For Mojave and newer (>= 10.14)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AutomaticallyInstallAppUpdates' -bool true
                    --level function. Favor higher-level functions like `ClearDirectoryContents` and `DeleteFiles`.
                        name: Disable macOS beta release installation
                        docs: https://web.archive.org/web/20170106103856/https://support.apple.com/en-gb/HT203018
                        code: |- Grants permission on items of the parent directory recursively (including all files and directories) to be able to delete them.
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AllowPreReleaseInstallation' -bool false
                        revertCode: |-
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'AllowPreReleaseInstallation' -bool true
                    -
                        name: Disable automatic installation for configuration data (e.g. XProtect, Gatekeeper, MRT)
                        docs: https://web.archive.org/web/20240321170251/https://derflounder.wordpress.com/2018/12/28/enabling-automatic-macos-software-updates-for-os-x-yosemite-through-macos-mojave/
                        code: |-ons }}sudo{{ end }} rm -{{ with $recurse }}r{{end}}fv $glob_pattern
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'ConfigDataInstall' -bool false
                        revertCode: |-o delete directories.
                            # For OS X Yosemite and newer (>= 10.10)
                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'ConfigDataInstall' -bool true
                    -rmissions # Specifies whether to run the operation with higher privileges.
                        name: Disable automatic installation for system data files and security updates
                        docs: |-
                            This script stops automatic installations of critical updates [1],
                            including security [1] [2] [3] [4] [5] [6] [7] and system data file [1] [8] updates.
          codeComment: >-
                            It improves privacy by providing:
      - function: DeleteGlob
                            - **Control Over Update Timing**:
                              Users can review updates before installation to ensure they meet privacy standards and do not introduce
                              unwanted telemetry or changes.e{{ end }}"
                            - **Reduced External Communications**:                              Reduces how often it connects to update servers, potentially protection user information.                            The script configures the `/Library/Preferences/com.apple.SoftwareUpdate!CriticalUpdateInstall` setting [1] [4] [5] [7] [8].                            This action prevents automatic downloads and installations of updates [1].                            It also prevents users from changing the Install system data files and security updates option manually [1].                            This script is compatible with OS X Yosemite and later versions [6] [8].                            The revert script triggers `softwareupdate --background-critical` to install any pending critical updates directly [2] [9].                            > **Caution:**                            > Only disable automatic updates if you're committed to manually installing them quickly to maintain your computer's security [4] [5] [8].                            > It's important to install updates soon to protect your computer. [4] [5] [8].                            >                            > This script disables:                            >                            > - Definition updates for **XProtect** and **Gatekeeper** that keep your computer safe from new threats [5].                            > - **Rapid Security Response** [10] [11].                            >   **Rapid Security Responses** are software releases providing important security improvements between standard updates [12].                            [1]: https://archive.ph/2024.03.21-180353/https://developer.apple.com/documentation/devicemanagement/softwareupdate "SoftwareUpdate | Apple Developer Documentation | developer.apple.com"                            [2]: https://web.archive.org/web/20240321201417/https://derflounder.wordpress.com/2014/12/24/managing-os-xs-automatic-security-updates/ "Managing OS X‚Äôs automatic security updates | Der Flounder | derflounder.wordpress.com"                            [3]: https://web.archive.org/web/20240321165118/https://macadminsdoc.readthedocs.io/en/master/Profiles-and-Settings/OS-X-Updates.html "macOS Updates ‚Äî MacAdmins Community Documentation documentation | macadminsdoc.readthedocs.io"                            [4]: https://web.archive.org/web/20240321165931/https://csrc.nist.gov/CSRC/media/Projects/national-vulnerability-database/documents/CCE/CCE-macos_monterey.xls "CCE-91129-7 | CCE-macos_monterey.xls | Sheet 1 - NIST Computer Security Resource Center | csrc.nist.gov"                            [5]: https://web.archive.org/web/20240321201450/https://paper.bobylive.com/Security/CIS/CIS_Apple_OSX_10_9_Benchmark_v1_3_0.pdf "CIS Apple OSX 10.9 Benchmark | paper.bobylive.com"                            [6]: https://web.archive.org/web/20240321201643/https://derflounder.wordpress.com/2014/12/27/managing-automatic-installation-of-configdata-and-security-software-updates-on-yosemite/ "Managing automatic installation of ConfigData and security software updates on Yosemite | Der Flounder | derflounder.wordpress.com"                            [7]: https://web.archive.org/web/20240321201652/https://ss64.com/mac/syntax-defaults.html "System preference settings for macOS - macOS - SS64.com | ss64.com"                            [8]: https://web.archive.org/web/20240321201436/https://www.tenable.com/audits/items/CIS_OSX_10.10_v1.2.0_L1.audit:97f36c2eaa06045e85a1beff1a76a088 "1.4 Enable system data files and security update installs - 'C... | Tenable¬Æ | www.tenable.com"                            [9]: https://web.archive.org/web/20240321201406/https://managingosx.wordpress.com/2013/04/30/undocumented-options/ "Undocumented options ‚Äì Managing OS X | managingosx.wordpress.com"                            [10]: https://web.archive.org/web/20240321201558/https://www.intuneirl.com/rapid-security-response/ "Managing Rapid Security Response on Apple Devices | www.intuneirl.com"                            [11]: https://web.archive.org/web/20240321201614/https://onsitegroup.co.za/rapid-security-response/ "Rapid security response - Onsite | onsitegroup.co.za"                            [12]: https://web.archive.org/web/20240321201623/https://support.apple.com/en-us/102657 "About Rapid Security Responses for iOS, iPadOS, and macOS - Apple Support | support.apple.com"                        code: |-                            # For OS X Yosemite and newer (>= 10.10)                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'CriticalUpdateInstall' -bool false                        revertCode: |-                            # For OS X Yosemite and newer (>= 10.10)                            sudo defaults write /Library/Preferences/com.apple.SoftwareUpdate 'CriticalUpdateInstall' -bool true                            # Trigger background check with normal scan (critical updates only)                            sudo softwareupdate --background-criticalfunctions:    -        name: PersistUserEnvironmentConfiguration        parameters:            - name: configuration        code: |-            command='{{ $configuration }}'            declare -a profile_files=("$HOME/.bash_profile" "$HOME/.zprofile")            for profile_file in "${profile_files[@]}"            do                touch "$profile_file"                if ! grep -q "$command" "${profile_file}"; then                    echo "$command" >> "$profile_file"                    echo "[$profile_file] Configured"                else                    echo "[$profile_file] No need for any action, already configured"                fi            done        revertCode: |-            command='{{ $configuration }}'            declare -a profile_files=("$HOME/.bash_profile" "$HOME/.zprofile")            for profile_file in "${profile_files[@]}"            do                if grep -q "$command" "${profile_file}" 2>/dev/null; then                    sed -i '' "/$command/d" "$profile_file"                    echo "[$profile_file] Reverted configuration"                else                    echo "[$profile_file] No need for any action, configuration does not exist"                fi            done    -        name: RunIfCommandExists # Skips if command does not exist        #   Marked: refactor-with-partials        #     Same function as Linux        parameters:            - name: command            - name: code            - name: revertCode              optional: true        code: |-            if ! command -v '{{ $command }}' &> /dev/null; then                echo 'Skipping because "{{ $command }}" is not found.'            else                {{ $code }}            fi        revertCode: |-            {{ with $revertCode }}                if ! command -v '{{ $command }}' &> /dev/null; then                    >&2 echo 'Cannot revert because "{{ $command }}" is not found.'                else                    {{ . }}                fi            {{ end }}    -        name: ResetServicePermissions        parameters:            - name: serviceId # Specifies the service ID for which to reset permissions        docs: |-            This function resets the specified service ID permissions.            The `serviceId` parameter allows you to define the specific service ID (e.g., Camera, Microphone,            Accessibility) for which you want to reset all user-granted permissions.        call:            function: RunIfCommandExists            parameters:                command: tccutil                code: |-                    declare serviceId='{{ $serviceId }}'                    declare reset_output reset_exit_code                    {                        reset_output=$(tccutil reset "$serviceId" 2>&1)                        reset_exit_code=$?                    }                    if [ $reset_exit_code -eq 0 ]; then                        echo "Successfully reset permissions for \"${serviceId}\"."                    elif [ $reset_exit_code -eq 70 ]; then                        echo "Skipping, service ID \"${serviceId}\" is not supported on your operating system version."                    elif [ $reset_exit_code -ne 0 ]; then                        >&2 echo "Failed to reset permissions for \"${serviceId}\". Exit code: $reset_exit_code."                        if [ -n "$reset_output" ]; then                            echo "Output from \`tccutil\`: $reset_output."                        fi                    fi    -        name: RunInlineCode        #   Marked: refactor-with-partials        #     Same function in macOS, Linux, Windows        parameters:            - name: code            - name: revertCode              optional: true        code: '{{ $code }}'        revertCode: '{{ with $revertCode }}{{ . }}{{ end }}'    -        name: Comment        # üí° Purpose:        #   Adds a comment in the executed code for better readability and debugging.        #   This function does not affect the execution flow but helps in understanding the purpose of subsequent code.        #   Marked: refactor-with-partials        #     Same function as Linux        parameters:            - name: codeComment              optional: true            - name: revertCodeComment              optional: true        call:            function: RunInlineCode            parameters:                code: '{{ with $codeComment }}# {{ . }}{{ end }}'                revertCode: '{{ with $revertCodeComment }}# {{ . }}{{ end }}'    -        name: ClearDirectoryContents        # üí° Purpose:        #   Empties the contents of a directory recursively (including all of its files and subfolders) while preserving        #   the directory itself.        #   This is beneficial when other applications depend on the existence of the directory.        #   Marked: refactor-with-partials        #     Same function as Linux        parameters:            - name: directoryGlob            - name: grantPermissions              optional: true        call:            -                function: Comment                parameters:                    codeComment: 'Clear directory contents: "{{ $directoryGlob }}"'            -                function: DeleteGlob                parameters:                    pathGlob: "{{ $directoryGlob }}/*"                    grantPermissions: '{{ with $grantPermissions }}true{{ end }}'                    recurse: 'true'    -        name: DeleteGlob        # üí° Usage:        #   This is a low-level function. Favor higher-level functions like `ClearDirectoryContents` and `DeleteFiles`.        parameters:            - name: pathGlob            # Glob pattern for search.            - name: grantPermissions    # Grants permission on items of the parent directory recursively (including all files and directories) to be able to delete them.              optional: true            - name: recurse             # If set, deletes all files and directories recursively.              optional: true        call:            function: RunInlineCode            parameters:                code: |-                    glob_pattern="{{ $pathGlob }}"                    {{ with $grantPermissions }}sudo{{ end }} rm -{{ with $recurse }}r{{end}}fv $glob_pattern    -        name: DeleteFiles        # üí° Purpose:        #   Use `ClearDirectoryContents` to delete directories.        parameters:            - name: fileGlob            # File glob pattern to delete.            - name: grantPermissions    # Specifies whether to run the operation with higher privileges.              optional: true        call:            -                function: Comment                parameters:                    codeComment: >-                        Delete files matching pattern: "{{ $fileGlob }}"            -                function: DeleteGlob                parameters:                    pathGlob: '{{ $fileGlob }}'                    grantPermissions: '{{ with $grantPermissions }}true{{ end }}'